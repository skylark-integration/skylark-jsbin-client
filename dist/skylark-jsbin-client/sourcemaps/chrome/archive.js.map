{"version":3,"sources":["chrome/archive.js"],"names":["define","$","jsbin","analytics","updateArchiveMenu","state","metadata","archive","hide","show","unarchive","type","text","getURL","withRevision","user","name","owner","ajax","url","error","$document","trigger","content","success","autohide"],"mappings":";;;;;;;AAAAA,QACE,iBACC,WACA,eACD,SAAUC,EAAEC,EAAMC,GAwClB,SAASC,IACHF,EAAMG,MAAMC,UAAYJ,EAAMG,MAAMC,SAASC,SAC/CN,EAAE,gBAAgBO,OAClBP,EAAE,kBAAkBQ,SAEpBR,EAAE,gBAAgBQ,OAClBR,EAAE,kBAAkBO,QAMxB,OAFAJ,IAEOF,EAAMK,QAnDb,SAAiBG,GAEf,aACA,IAAIC,GAAqB,IAAdD,EAAsB,YAAc,UAC3CE,GAAqB,IAAdF,EAAsB,uBAAyB,YAC1DP,EAAUQ,GAAMT,EAAMW,QAASC,cAAc,KACxCZ,EAAMa,KAAKC,KAKLd,EAAMe,QACfhB,EAAEiB,MACAP,KAAM,OACNQ,IAAKjB,EAAMW,QAASC,cAAc,IAAU,IAAMH,EAClDS,MAAO,WACLlB,EAAMmB,UAAUC,QAAQ,OACtBX,KAAM,QACNY,QAAS,OAASX,EAAO,+DAG7BY,QAAS,WACPtB,EAAMG,MAAMC,SAASC,SAAwB,IAAdG,EAC/BN,IACAF,EAAMmB,UAAUC,QAAQ,OACtBX,KAAM,aACNc,SAAU,IACVF,QAAS,qBAAoC,IAAdb,EAAsB,6BAA+B,kBAK1FR,EAAMmB,UAAUC,QAAQ,OACtBX,KAAM,aACNY,QAAS,OAASX,EAAO,qDA3B3BV,EAAMmB,UAAUC,QAAQ,OACtBX,KAAM,aACNY,QAAS","file":"../../chrome/archive.js","sourcesContent":["define([\r\n  \"skylark-jquery\",\r\n   \"../jsbin\",\r\n   \"./analytics\"\r\n],function ($,jsbin,analytics) {\r\n  function archive(unarchive) {\r\n    /*global jsbin, $, $document, analytics*/\r\n    'use strict';\r\n    var type = unarchive === false ? 'unarchive' : 'archive';\r\n    var text = unarchive === false ? 'restore from archive' : 'archiving';\r\n    analytics[type](jsbin.getURL({ withRevision: true }));\r\n    if (!jsbin.user.name) {\r\n      jsbin.$document.trigger('tip', {\r\n        type: 'notication',\r\n        content: 'You must be logged in and the owner of the bin to archive.'\r\n      });\r\n    } else if (jsbin.owner()) {\r\n      $.ajax({\r\n        type: 'POST',\r\n        url: jsbin.getURL({ withRevision: true }) + '/' + type,\r\n        error: function () {\r\n          jsbin.$document.trigger('tip', {\r\n            type: 'error',\r\n            content: 'The ' + text + ' failed. If this continues, please can you file an issue?'\r\n          });\r\n        },\r\n        success: function () {\r\n          jsbin.state.metadata.archive = unarchive !== false;\r\n          updateArchiveMenu();\r\n          jsbin.$document.trigger('tip', {\r\n            type: 'notication',\r\n            autohide: 5000,\r\n            content: 'This bin is now ' + (unarchive === false ? 'restored from the archive.' : 'archived.')\r\n          });\r\n        }\r\n      });\r\n    } else {\r\n      jsbin.$document.trigger('tip', {\r\n        type: 'notication',\r\n        content: 'The ' + text + ' failed. You can only archive bins that you own.'\r\n      });\r\n    }\r\n  }\r\n\r\n  function updateArchiveMenu() {\r\n    if (jsbin.state.metadata && jsbin.state.metadata.archive) {\r\n      $('a.archivebin').hide();\r\n      $('a.unarchivebin').show();\r\n    } else {\r\n      $('a.archivebin').show();\r\n      $('a.unarchivebin').hide();\r\n    }\r\n  }\r\n\r\n  updateArchiveMenu();\r\n\r\n  return jsbin.archive = archive;\r\n});"]}