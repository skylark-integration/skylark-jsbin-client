{"version":3,"sources":["chrome/storage.js"],"names":["define","$","jsbin","hasStore","type","window","e","sessionStorage","localStorage","data","keys","s","polyfill","name","JSON","parse","Object","key","i","length","clear","getItem","removeItem","stringify","setItem","value","forEach","extend","embed","document","one","trigger","content","saveDisabled","sandbox"],"mappings":";;;;;;;AAAAA,QACE,iBACC,YACD,SAAUC,EAAEC,GACZ,SAASC,EAASC,GAChB,IACE,OAAOA,KAAQC,QAA2B,OAAjBA,OAAOD,GAChC,MAAME,GACN,OAAO,GAKX,IAIIC,EACAC,EAKIC,EACAC,EAGAC,EAdJC,GAAW,EAmEf,OA5DKT,EAAS,kBAuCZI,EAAiBF,OAAOE,gBAtCxBK,GAAW,EAELH,EAAOJ,OAAOQ,KAAOC,KAAKC,MAAMV,OAAOQ,SACvCH,EAAOM,OAAON,KAAKD,GAGnBE,GACFM,IAAK,SAAUC,GACb,OAAOF,OAAON,KAAKD,GAAMS,IAAM,MAEjCC,OANWT,EAAKS,OAOhBC,MAAO,WACLX,KACAJ,OAAOQ,KAAO,GACdF,EAAEQ,OAAS,GAEbE,QAAS,SAAUJ,GACjB,OAAOR,EAAKQ,IAAQ,MAEtBK,WAAY,SAAUL,UACbR,EAAKQ,GACZZ,OAAOQ,KAAOC,KAAKS,UAAUd,GAC7BE,EAAEQ,UAEJK,QAAS,SAAUP,EAAKQ,GACtBhB,EAAKQ,GAAOQ,EACZpB,OAAOQ,KAAOC,KAAKS,UAAUd,GAC7BE,EAAEQ,WAINT,EAAKgB,QAAQ,SAAUT,GACrBN,EAAEM,GAAOR,EAAKQ,KA/BlBV,EAkCSI,GAMNR,EAAS,gBAGHA,EAAS,kBAClBK,EAAeH,OAAOG,cAFtBA,EAAeP,EAAE0B,UAAWpB,IAKzBL,EAAM0B,OAAShB,IAClBX,EAAE4B,UAAUC,IAAI,aAAc,WAC5B7B,EAAE4B,UAAUE,QAAQ,OAClB3B,KAAM,QACN4B,QAAS,4HAGb9B,EAAM+B,cAAe,EACrB/B,EAAMgC,SAAU,IAIhBtB,SAAUA,EACVL,eAAgBA,EAChBC,aAAcA","file":"../../chrome/storage.js","sourcesContent":["define([\r\n  \"skylark-jquery\",\r\n   \"../jsbin\"\r\n],function ($,jsbin) {\r\n  function hasStore(type) {\r\n    try {\r\n      return type in window && window[type] !== null;\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  \"use strict\";\r\n  var polyfill = false;\r\n\r\n  // Firefox with Cookies disabled triggers a security error when we probe window.sessionStorage\r\n  // currently we're just disabling all the session features if that's the case.\r\n  var sessionStorage;\r\n  var localStorage;\r\n\r\n  if (!hasStore('sessionStorage')) {\r\n    polyfill = true;\r\n    sessionStorage = (function () {\r\n      var data = window.name ? JSON.parse(window.name) : {};\r\n      var keys = Object.keys(data);\r\n      var length = keys.length;\r\n\r\n      var s = {\r\n        key: function (i) {\r\n          return Object.keys(data)[i] || null;\r\n        },\r\n        length: length,\r\n        clear: function () {\r\n          data = {};\r\n          window.name = '';\r\n          s.length = 0;\r\n        },\r\n        getItem: function (key) {\r\n          return data[key] || null;\r\n        },\r\n        removeItem: function (key) {\r\n          delete data[key];\r\n          window.name = JSON.stringify(data);\r\n          s.length--;\r\n        },\r\n        setItem: function (key, value) {\r\n          data[key] = value;\r\n          window.name = JSON.stringify(data);\r\n          s.length++;\r\n        }\r\n      };\r\n\r\n      keys.forEach(function (key) {\r\n        s[key] = data[key];\r\n      });\r\n\r\n      return s;\r\n    })();\r\n  } else {\r\n    sessionStorage = window.sessionStorage;\r\n  }\r\n\r\n  if (!hasStore('localStorage')) {\r\n    // dirty, but will do for our purposes\r\n    localStorage = $.extend({}, sessionStorage);\r\n  } else if (hasStore('localStorage')) {\r\n    localStorage = window.localStorage;\r\n  }\r\n\r\n  if (!jsbin.embed && polyfill) {\r\n    $(document).one('jsbinReady', function () {\r\n      $(document).trigger('tip', {\r\n        type: 'error',\r\n        content: 'JS Bin uses cookies to protect against CSRF attacks, so with cookies disabled, you will not be able to save your work'\r\n      });\r\n    });\r\n    jsbin.saveDisabled = true;\r\n    jsbin.sandbox = true;\r\n  }\r\n\r\n  return { \r\n    polyfill: polyfill, \r\n    sessionStorage: sessionStorage, \r\n    localStorage: localStorage \r\n  };\r\n\r\n});\r\n\r\n"]}