{"version":3,"sources":["chrome/login.js"],"names":["define","$","jsbin","submit","event","preventDefault","form","this","name","find","val","key","email","$loginFeedback","show","text","ajax","url","attr","data","username","type","dataType","complete","jqXHR","parseJSON","responseText","status","avatar","remove","end","prepend","message","window","location","pathname","search","analytics","login"],"mappings":";;;;;;;AAAAA,QACE,iBACC,YACD,SAAUC,EAAEC,GAGZD,EAAE,cAAcE,OAAO,SAAUC,GAC/B,aACAA,EAAMC,iBAEN,IAAIC,EAAOL,EAAEM,MACTC,EAAOF,EAAKG,KAAK,wBAAwBC,MACzCC,EAAML,EAAKG,KAAK,wBAAwBC,MACxCE,EAAQN,EAAKG,KAAK,qBAAqBC,MACvCG,EAAiBP,EAAKG,KAAK,kBAI/BI,EAAeC,OAAOC,KAAK,eAE3Bd,EAAEe,MACAC,IAAKX,EAAKY,KAAK,UACfC,MAAQC,SAAUZ,EAAMG,IAAKA,EAAKC,MAAOA,GACzCS,KAAM,OACNC,SAAU,OACVC,SAAU,SAAUC,GAClB,IAAIL,EAAOlB,EAAEwB,UAAUD,EAAME,kBAER,MAAjBF,EAAMG,QACJR,EAAKS,QACP3B,EAAE,YAAYQ,KAAK,OAAOoB,SAASC,MAAMC,QAAQ,aAAeZ,EAAKS,OAAS,MAE5ET,EAAKa,QACPnB,EAAeE,KAAKI,EAAKa,SAEzBC,OAAOC,SAAWD,OAAOC,SAASC,SAAWF,OAAOC,SAASE,SAG/DC,UAAUC,OAAM,GAChBzB,EAAeE,KAAKI,EAAKa,SAAY,IAAMxB,EAAO","file":"../../chrome/login.js","sourcesContent":["define([\r\n  \"skylark-jquery\",\r\n   \"../jsbin\"\r\n],function ($,jsbin) {\r\n  /* global $ */\r\n\r\n  $('form.login').submit(function (event) {\r\n    'use strict';\r\n    event.preventDefault();\r\n\r\n    var form = $(this),\r\n        name = form.find('input[name=username]').val(),\r\n        key = form.find('input[name=password]').val(),\r\n        email = form.find('input[name=email]').val(),\r\n        $loginFeedback = form.find('.loginFeedback');\r\n\r\n\r\n    // jsbin.settings.home = name; // will save later\r\n    $loginFeedback.show().text('Checking...');\r\n\r\n    $.ajax({\r\n      url: form.attr('action'),\r\n      data: { username: name, key: key, email: email },\r\n      type: 'POST',\r\n      dataType: 'json',\r\n      complete: function (jqXHR) {\r\n        var data = $.parseJSON(jqXHR.responseText) || {};\r\n        // cookie is required to share with the server so we can do a redirect on new bin\r\n        if (jqXHR.status === 200) {\r\n          if (data.avatar) {\r\n            $('a.avatar').find('img').remove().end().prepend('<img src=\"' + data.avatar + '\">');\r\n          }\r\n          if (data.message) {\r\n            $loginFeedback.text(data.message);\r\n          } else {\r\n            window.location = window.location.pathname + window.location.search;\r\n          }\r\n        } else {\r\n          analytics.login(false);\r\n          $loginFeedback.text(data.message || ('\"' + name + '\" has already been taken. Please either double check the password, or choose another username.'));\r\n        }\r\n      }\r\n    });\r\n  });\r\n\r\n});"]}