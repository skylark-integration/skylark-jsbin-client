/**
 * skylark-jsbin-client - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-client/
 * @license MIT
 */
define(["skylark-jquery","skylark-jsbin-coder/editors/panels","../jsbin"],function(e,s,t){"use strict";if(0!==e("#sharemenu .share-split").length){var a={live:"output",javascript:"js"},n=e('#sharepanels input[type="checkbox"]'),i=t.state.revision;t.$document.on("saved",function(){i=t.state.revision}),t.$document.on("snapshot",function(){t.state.changed=!1,window.history.replaceState&&window.history.replaceState(null,"",t.getURL({withRevision:!0})+"/edit?"+s.getQuery())});var o=e("#sharemenu").bind("open",function(){n.prop("checked",!1),t.panels.getVisible().forEach(function(e){n.filter('[value="'+(a[e.id]||e.id)+'"]').prop("checked",!0)}),t.state.latest?(t.state.checksum?(c.prop("checked",t.state.latest),p.prop("checked",!1),v.show()):(c.prop({checked:!1}),p.prop("checked",!0),v.hide()),m.show()):(c.prop({checked:!1,disabled:!0}),p.prop("checked",!0),m.hide()),j()});o.find(".lockrevision").on("change",function(){t.saveChecksum=!1,t.state.checksum=!1,t.$document.trigger("locked")});var r=e("#share-preview"),c=e('#sharebintype input[type=radio][value="realtime"]'),p=e('#sharebintype input[type=radio][value="snapshot"]'),h=o.find("a.link")[0],d=o.find('input[name="url"]')[0],u=o.find("textarea")[0],l=o.find("form")[0],f=o.find(".direct-links"),v=e("#andlive"),m=o.find(".codecasting");e("#sharebintype input[type=radio]").on("change",function(){"snapshot"===this.value?(t.state.checksum=!1,t.saveChecksum=!1,m.hide()):m.show()}),o.find("input").on("change",j),t.$document.on("saved",function(){c.prop("checked",!0),o.removeClass("hidden"),j()});var k=e("#share").closest(".menu"),g=e("#sharemenu a")[0],b=e("a.show-share").on("click",function(){k.hasClass("open")?closedropdown(g):opendropdown(g,!0),b.blur()})}function j(){var e=function(e){for(var s,t,a,n,i=e.length,o={},r=function(e,s,t){void 0===e[s]?e[s]=t:("string"==typeof e[s]&&(e[s]=[e[s]]),e[s].push(t))},c=0;c<i;c++)s=(t=e[c]).value,a=t.type,n=t.name,"radio"===a?t.checked&&r(o,n,s):"checkbox"===a?(void 0===o[n]&&(o[n]=[]),t.checked&&r(o,n,s)):r(o,n,s);return o}(l),s=t.getURL({root:t.shareRoot}),a=t.getURL();"snapshot"===e.state&&t.state.latest&&(s+="/"+i,a+="/"+i);var o=s,c=e.panel.join(",");c&&(c="?"+c),n.prop("disabled","output"===e.view),r.attr("class",e.view),"output"!==e.view&&r.find(".editor div").each(function(){this.hidden=-1===e.panel.indexOf(this.className)}),"editor"===e.view?o+="/edit":c="",f.empty();var p=[],v="",m="";if((v=t.panels.named.html.getCode().trim())&&("html"!==(m=processors[t.state.processors.html||"html"].extensions[0])?p.push('<a target="_blank" href="'+s+"."+m+'">'+m+"</a>"):0===v.toLowerCase().indexOf("<svg")&&p.push('<a target="_blank" href="'+s+'.svg">svg</a>')),t.panels.named.css.getCode().trim()&&("css"!==(m=processors[t.state.processors.css||"css"].extensions[0])&&p.push('<a target="_blank" href="'+s+'.css">css</a>'),p.push('<a target="_blank" href="'+s+"."+m+'">'+m+"</a>")),v=t.panels.named.javascript.getCode().trim()){"js"!==(m=processors[t.state.processors.javascript||"javascript"].extensions[0])&&p.push('<a target="_blank" href="'+s+'.js">js</a>');try{JSON.parse(v),p.push('<a target="_blank" href="'+s+'.json">json</a>')}catch(e){p.push('<a target="_blank" href="'+s+"."+m+'">'+m+"</a>")}}f.html(p.join("")),d.value=h.href=o+c,u.value=('<a class="jsbin-embed" href="'+a+"/embed"+c+'">'+t.documentTitle+' on jsbin.com</a><script src="'+t.static+"/js/embed.min.js?"+t.version+'"><\/script>').replace(/<>"&/g,function(e){return{"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;"}[e]})}});
//# sourceMappingURL=../sourcemaps/chrome/share.js.map
