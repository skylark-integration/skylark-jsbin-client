/**
 * skylark-jsbin-client - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-client/
 * @license MIT
 */
define(["skylark-jquery","skylark-jsbin-processors","skylark-jsbin-coder/editors/panels","../jsbin"],function(e,t,s,a){"use strict";if(0!==e("#sharemenu .share-split").length){var n={live:"output",javascript:"js"},i=e('#sharepanels input[type="checkbox"]'),o=a.state.revision;a.$document.on("saved",function(){o=a.state.revision}),a.$document.on("snapshot",function(){a.state.changed=!1,window.history.replaceState&&window.history.replaceState(null,"",a.getURL({withRevision:!0})+"/edit?"+s.getQuery())});var r=e("#sharemenu").bind("open",function(){i.prop("checked",!1),s.getVisible().forEach(function(e){i.filter('[value="'+(n[e.id]||e.id)+'"]').prop("checked",!0)}),a.state.latest?(a.state.checksum?(h.prop("checked",a.state.latest),d.prop("checked",!1),m.show()):(h.prop({checked:!1}),d.prop("checked",!0),m.hide()),k.show()):(h.prop({checked:!1,disabled:!0}),d.prop("checked",!0),k.hide()),y()});r.find(".lockrevision").on("change",function(){a.saveChecksum=!1,a.state.checksum=!1,a.$document.trigger("locked")});var c=e("#share-preview"),h=e('#sharebintype input[type=radio][value="realtime"]'),d=e('#sharebintype input[type=radio][value="snapshot"]'),p=r.find("a.link")[0],u=r.find('input[name="url"]')[0],l=r.find("textarea")[0],f=r.find("form")[0],v=r.find(".direct-links"),m=e("#andlive"),k=r.find(".codecasting");e("#sharebintype input[type=radio]").on("change",function(){"snapshot"===this.value?(a.state.checksum=!1,a.saveChecksum=!1,k.hide()):k.show()}),r.find("input").on("change",y),a.$document.on("saved",function(){h.prop("checked",!0),r.removeClass("hidden"),y()});var g=e("#share").closest(".menu"),b=e("#sharemenu a")[0],j=e("a.show-share").on("click",function(){g.hasClass("open")?closedropdown(b):opendropdown(b,!0),j.blur()})}function y(){var e=function(e){for(var t,s,a,n,i=e.length,o={},r=function(e,t,s){void 0===e[t]?e[t]=s:("string"==typeof e[t]&&(e[t]=[e[t]]),e[t].push(s))},c=0;c<i;c++)t=(s=e[c]).value,a=s.type,n=s.name,"radio"===a?s.checked&&r(o,n,t):"checkbox"===a?(void 0===o[n]&&(o[n]=[]),s.checked&&r(o,n,t)):r(o,n,t);return o}(f),n=a.getURL({root:a.shareRoot}),r=a.getURL();"snapshot"===e.state&&a.state.latest&&(n+="/"+o,r+="/"+o);var h=n,d=e.panel.join(",");d&&(d="?"+d),i.prop("disabled","output"===e.view),c.attr("class",e.view),"output"!==e.view&&c.find(".editor div").each(function(){this.hidden=-1===e.panel.indexOf(this.className)}),"editor"===e.view?h+="/edit":d="",v.empty();var m=[],k="",g="";if((k=s.named.html.getCode().trim())&&("html"!==(g=t[a.state.processors.html||"html"].extensions[0])?m.push('<a target="_blank" href="'+n+"."+g+'">'+g+"</a>"):0===k.toLowerCase().indexOf("<svg")&&m.push('<a target="_blank" href="'+n+'.svg">svg</a>')),s.named.css.getCode().trim()&&("css"!==(g=t[a.state.processors.css||"css"].extensions[0])&&m.push('<a target="_blank" href="'+n+'.css">css</a>'),m.push('<a target="_blank" href="'+n+"."+g+'">'+g+"</a>")),k=s.named.javascript.getCode().trim()){"js"!==(g=t[a.state.processors.javascript||"javascript"].extensions[0])&&m.push('<a target="_blank" href="'+n+'.js">js</a>');try{JSON.parse(k),m.push('<a target="_blank" href="'+n+'.json">json</a>')}catch(e){m.push('<a target="_blank" href="'+n+"."+g+'">'+g+"</a>")}}v.html(m.join("")),u.value=p.href=h+d,l.value=('<a class="jsbin-embed" href="'+r+"/embed"+d+'">'+a.documentTitle+' on jsbin.com</a><script src="'+a.static+"/js/embed.min.js?"+a.version+'"><\/script>').replace(/<>"&/g,function(e){return{"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;"}[e]})}});
//# sourceMappingURL=../sourcemaps/chrome/share.js.map
