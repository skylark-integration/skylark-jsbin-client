/**
 * skylark-jsbin-client - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-client/
 * @license MIT
 */
define(["skylark-jquery","skylark-jsbin-coder/editors/panels","../jsbin"],function(e,t,s){"use strict";if(0!==e("#sharemenu .share-split").length){var a={live:"output",javascript:"js"},n=e('#sharepanels input[type="checkbox"]'),i=s.state.revision;s.$document.on("saved",function(){i=s.state.revision}),s.$document.on("snapshot",function(){s.state.changed=!1,window.history.replaceState&&window.history.replaceState(null,"",s.getURL({withRevision:!0})+"/edit?"+t.getQuery())});var o=e("#sharemenu").bind("open",function(){n.prop("checked",!1),t.getVisible().forEach(function(e){n.filter('[value="'+(a[e.id]||e.id)+'"]').prop("checked",!0)}),s.state.latest?(s.state.checksum?(c.prop("checked",s.state.latest),h.prop("checked",!1),v.show()):(c.prop({checked:!1}),h.prop("checked",!0),v.hide()),m.show()):(c.prop({checked:!1,disabled:!0}),h.prop("checked",!0),m.hide()),j()});o.find(".lockrevision").on("change",function(){s.saveChecksum=!1,s.state.checksum=!1,s.$document.trigger("locked")});var r=e("#share-preview"),c=e('#sharebintype input[type=radio][value="realtime"]'),h=e('#sharebintype input[type=radio][value="snapshot"]'),p=o.find("a.link")[0],d=o.find('input[name="url"]')[0],u=o.find("textarea")[0],l=o.find("form")[0],f=o.find(".direct-links"),v=e("#andlive"),m=o.find(".codecasting");e("#sharebintype input[type=radio]").on("change",function(){"snapshot"===this.value?(s.state.checksum=!1,s.saveChecksum=!1,m.hide()):m.show()}),o.find("input").on("change",j),s.$document.on("saved",function(){c.prop("checked",!0),o.removeClass("hidden"),j()});var k=e("#share").closest(".menu"),g=e("#sharemenu a")[0],b=e("a.show-share").on("click",function(){k.hasClass("open")?closedropdown(g):opendropdown(g,!0),b.blur()})}function j(){var e=function(e){for(var t,s,a,n,i=e.length,o={},r=function(e,t,s){void 0===e[t]?e[t]=s:("string"==typeof e[t]&&(e[t]=[e[t]]),e[t].push(s))},c=0;c<i;c++)t=(s=e[c]).value,a=s.type,n=s.name,"radio"===a?s.checked&&r(o,n,t):"checkbox"===a?(void 0===o[n]&&(o[n]=[]),s.checked&&r(o,n,t)):r(o,n,t);return o}(l),a=s.getURL({root:s.shareRoot}),o=s.getURL();"snapshot"===e.state&&s.state.latest&&(a+="/"+i,o+="/"+i);var c=a,h=e.panel.join(",");h&&(h="?"+h),n.prop("disabled","output"===e.view),r.attr("class",e.view),"output"!==e.view&&r.find(".editor div").each(function(){this.hidden=-1===e.panel.indexOf(this.className)}),"editor"===e.view?c+="/edit":h="",f.empty();var v=[],m="",k="";if((m=t.named.html.getCode().trim())&&("html"!==(k=processors[s.state.processors.html||"html"].extensions[0])?v.push('<a target="_blank" href="'+a+"."+k+'">'+k+"</a>"):0===m.toLowerCase().indexOf("<svg")&&v.push('<a target="_blank" href="'+a+'.svg">svg</a>')),t.named.css.getCode().trim()&&("css"!==(k=processors[s.state.processors.css||"css"].extensions[0])&&v.push('<a target="_blank" href="'+a+'.css">css</a>'),v.push('<a target="_blank" href="'+a+"."+k+'">'+k+"</a>")),m=t.named.javascript.getCode().trim()){"js"!==(k=processors[s.state.processors.javascript||"javascript"].extensions[0])&&v.push('<a target="_blank" href="'+a+'.js">js</a>');try{JSON.parse(m),v.push('<a target="_blank" href="'+a+'.json">json</a>')}catch(e){v.push('<a target="_blank" href="'+a+"."+k+'">'+k+"</a>")}}f.html(v.join("")),d.value=p.href=c+h,u.value=('<a class="jsbin-embed" href="'+o+"/embed"+h+'">'+s.documentTitle+' on jsbin.com</a><script src="'+s.static+"/js/embed.min.js?"+s.version+'"><\/script>').replace(/<>"&/g,function(e){return{"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;"}[e]})}});
//# sourceMappingURL=../sourcemaps/chrome/share.js.map
