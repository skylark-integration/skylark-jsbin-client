/**
 * skylark-jsbin-client - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-client/
 * @license MIT
 */
!function(e,t){var n=t.define,require=t.require,o="function"==typeof n&&n.amd,s=!o&&"undefined"!=typeof exports;if(!o&&!n){var a={};n=t.define=function(e,t,n){"function"==typeof n?(a[e]={factory:n,deps:t.map(function(t){return function(e,t){if("."!==e[0])return e;var n=t.split("/"),i=e.split("/");n.pop();for(var o=0;o<i.length;o++)"."!=i[o]&&(".."==i[o]?n.pop():n.push(i[o]));return n.join("/")}(t,e)}),resolved:!1,exports:null},require(e)):a[e]={factory:null,resolved:!0,exports:n}},require=t.require=function(e){if(!a.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=a[e];if(!module.resolved){var n=[];module.deps.forEach(function(e){n.push(require(e))}),module.exports=module.factory.apply(t,n)||null,module.resolved=!0}return module.exports}}if(!n)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-jsbin-client/jsbin",["skylark-langx-ns","skylark-langx-objects","skylark-jquery"],function(e,t,n){"use strict";var i=e.attach("intg.jsbin");window.jsbin&&(t.mixin(i,window.jsbin),window.jsbin=i);try{console.log("Dave is ready.")}catch(e){window.console={log:function(){},warn:function(){},trace:function(){},error:function(){}}}function o(e,t){var n=function(){var i=this,o=arguments;n.cancel(),n.timer=setTimeout(function(){e.apply(i,o)},t)};return n.cancel=function(){clearTimeout(n.timer)},n}n.expr[":"].host=function(e,t,n){return e.host===n[3]};var s=store.localStorage.getItem("settings");("undefined"===s||i.embed)&&(s=null),i.user&&i.user.name?(i.settings=n.extend(!0,{},i.user.settings,i.settings),i.user.settings.font&&(i.settings.font=parseInt(i.user.settings.font,10))):i.settings=n.extend({},i.settings,JSON.parse(s||"{}")),i.mobile=/WebKit.*Mobile.*|Android/.test(navigator.userAgent),i.tablet=/iPad/i.test(navigator.userAgent),i.ie=function(){for(var e=3,t=document.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",n[0];);return e>4?e:void 0}(),s||location.origin+location.pathname!==i.root+"/"||store.localStorage.setItem("settings","{}"),i.settings.editor||(i.settings.editor={}),i.settings.codemirror&&n.extend(i.settings.editor,i.settings.codemirror),i.settings.editor.theme&&n(document.documentElement).addClass("cm-s-"+i.settings.editor.theme.split(" ")[0]),n.ajaxPrefilter(function(e,t,n){({head:1,get:1})[e.type.toLowerCase()]||e.url.match(/^https:\/\/api.github.com/)||n.setRequestHeader("x-csrf-token",i.state.token)}),i.owner=function(){return i.user&&i.user.name&&i.state.metadata&&i.state.metadata.name===i.user.name},i.getURL=function(e){e||(e={});var t=e.withoutRoot,n=e.root||i.root,o=t?"":n,s=i.state;return s.code&&(o+="/"+s.code,s.latest&&!e.withRevision||!1!==e.withRevision&&(o+="/"+(s.revision||1))),o},i.state.updateSettings=o(function(e,t){t||(t="POST"),i.state.code&&(e.checksum=i.state.checksum,n.ajax({type:t,url:i.getURL({withRevision:!0})+"/settings",data:e}))},500);var a,r=n(window),c=n("body"),l=n(document),u=(void 0!==i.settings.debug&&i.settings.debug,n("#bin")),d=function(){if(store.sessionStorage.setItem("url",i.getURL()),store.localStorage.setItem("settings",JSON.stringify(i.settings)),!1!==i.panels.saveOnExit){i.panels.save(),i.panels.savecontent();var e=i.panels.focused;e&&store.sessionStorage.setItem("panel",e.id)}};return r.unload(d),n.browser.opera&&setInterval(d,500),l.one("jsbinReady",function(){u.removeAttr("style"),c.addClass("ready")}),-1!==navigator.userAgent.indexOf(" Mac ")&&((a=n("#keyboardHelp")[0]).innerHTML=a.innerHTML.replace(/ctrl/g,"cmd").replace(/Ctrl/g,"ctrl")),i.embed&&r.on("focus",function(){return!1}),window.addEventListener("message",function(e){var t;try{t=JSON.parse(e.data)}catch(e){return}"cached"===t.type&&(t.updated>i.state.metadata.last_updated||!i.state.metadata.last_updated)&&(console.log("restored from cache: %sms newer",(new Date(t.updated).getTime()-new Date(i.state.metadata.last_updated).getTime())/100),i.panels.panels.html.setCode(t.template.html),i.panels.panels.javascript.setCode(t.template.javascript),i.panels.panels.css.setCode(t.template.css),n("a.save:first").click())}),function(){if(i.settings.debug){var e=document.createElement("pre");document.body.appendChild(e),e.tabindex=-1,t.mixin(e.style,{position:"fixed",padding:"2px",bottom:"20px",right:"20px",margin:0,fontSize:12,color:"#fff",background:"#aaa",whiteSpace:"pre-wrap",maxWidth:"95%",zIndex:1e7,pointerEvents:"none"});var n=null,o=function(){var t=document.activeElement,i="",s=t.attributes,a=0;if(t!==n&&t!==e){for(;a<s.length;a++)i+=" "+s[a].name+'="'+s[a].value+'"';e.textContent="<"+t.nodeName.toLowerCase()+i+">",n=t}requestAnimationFrame(o)};o()}}(),i.$document=l,i.$window=r,i.throttle=o,i.escapeHTML=function(e){return String(e).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},i}),e("skylark-jsbin-client/chrome/font",["skylark-jquery","../jsbin"],function(e,t){var n,i=function(e){var n=e.getElementsByTagName("head")[0],i="#output li, #exec, .fakeInput, .fakeInput:before, #exec:before, #bin .editbox .CodeMirror, .mobile .editbox textarea",o=t.settings.font||14;function s(t){var o=i+"{ font-size: "+t+"px; }",s=e.createElement("style");s.type="text/css",s.styleSheet?s.styleSheet.cssText=o:s.appendChild(e.createTextNode(o)),n.appendChild(s)}if(Object.defineProperty&&t.settings)try{Object.defineProperty(t.settings,"font",{configurable:!0,enumerable:!0,get:function(){return o},set:function(e){s(o=1*e)}})}catch(e){}return s(o),s}(document);function o(e){var t=document.createElement("style");t.innerHTML=e,document.head.appendChild(t)}try{(n=window.localStorage.getItem("fonts"))&&("a3a02e450f1f79f4c3482279d113b07e"===(n=JSON.parse(n)).md5?o(n.value):(window.localStorage.removeItem("fonts"),n=null))}catch(e){return}return n||window.addEventListener("load",function(){var e=new XMLHttpRequest,n=t.static+"/css/fonts.a3a02e450f1f79f4c3482279d113b07e.woff.json?"+t.version;e.open("GET",n,!0),e.onload=function(){if(200==this.status)try{o(JSON.parse(this.response).value),window.localStorage.setItem("fonts",this.response)}catch(e){}},e.send()}),t.font=i}),e("skylark-jsbin-client/chrome/splitter",["skylark-jquery","../jsbin"],function(e,t){e.fn.splitter=function(){var n=e(document),i=e('<div class="block"></div>'),o=e("body"),s=JSON.parse(store.localStorage.getItem("splitterSettings")||"[]");return this.each(function(){var a=e(this),r=(e(this),e.fn.splitter.guid++),c=a.parent(),l="x",u="x"===l?a.prevAll(":visible:first"):a.nextAll(":visible:first"),d=e('<div class="resize"></div>'),p=!1,h=(c.width(),c.offset()),f=(h.left,h.top),m={x:{currentPos:c.offset().left,multiplier:1,cssProp:"left",otherCssProp:"right",size:c.width(),sizeProp:"width",moveProp:"pageX",init:{top:0,bottom:0,width:t.mobile?44:8,"margin-left":t.mobile?"-22px":"-4px",height:"100%",left:"auto",right:"auto",opacity:0,position:"absolute",cursor:"ew-resize","border-left":"1px solid rgba(218, 218, 218, 0.5)","z-index":99999}},y:{currentPos:c.offset().top,multiplier:-1,size:c.height(),cssProp:"bottom",otherCssProp:"top",sizeProp:"height",moveProp:"pageY",init:{top:"auto",cursor:"ns-resize",bottom:"auto",height:8,width:"100%",left:0,right:0,opacity:0,position:"absolute",border:0,"z-index":99999}}},g=s[r]||{},v={down:{x:null,y:null},delta:{x:null,y:null},track:!1,timer:null};function b(e){"y"===l&&(e-=f);var t=e-m[l].currentPos,i=100/m[l].size*t,o=(e-g[l])*m[l].multiplier,c=u[m[l].sizeProp](),p=a[m[l].sizeProp]();if("y"===l&&(i=100-i),c<100&&o<0);else if(p<100&&o>0);else{a.css(m[l].cssProp,i+"%"),u.css(m[l].otherCssProp,100-i+"%");var h={};h[m[l].cssProp]=i+"%",d.css(h),g[l]=e,s[r]=g,store.localStorage.setItem("splitterSettings",JSON.stringify(s)),b.timer&&clearTimeout(b.timer),b.timer=setTimeout(function(){n.trigger("sizeeditors")},120)}}function y(){u="x"===l?d.prevAll(":visible:first"):d.nextAll(":visible:first")}d.bind("mousedown",function(e){v.down.x=e.pageX,v.down.y=e.pageY,v.delta={x:null,y:null},v.target=.25*d["x"==l?"height":"width"]()}),n.bind("mousemove",function(e){if(p){v.delta.x=v.down.x-e.pageX,v.delta.y=v.down.y-e.pageY,clearTimeout(v.timer),v.timer=setTimeout(function(){v.down.x=e.pageX,v.down.y=e.pageY},250);var t="x"==l?"y":"x";Math.abs(v.delta[t])>v.target&&(d.trigger("change",t,e[m[t].moveProp]),v.down.x=e.pageX,v.down.y=e.pageY)}}),n.bind("mouseup touchend",function(){p&&(p=!1,i.remove(),o.removeClass("dragging"))}).bind("mousemove touchmove",function(e){p&&b(e[m[l].moveProp]||e.originalEvent.touches[0][m[l].moveProp])}),i.bind("mousemove touchmove",function(e){p&&b(e[m[l].moveProp]||e.originalEvent.touches[0][m[l].moveProp])}),d.bind("mousedown touchstart",function(e){p=!0,o.append(i).addClass("dragging"),m[l].size=c[m[l].sizeProp](),m[l].currentPos=0,y(),e.preventDefault()}),d.bind("init",function(e,t){d.css(m[l].init),m[l].size=c[m[l].sizeProp](),y(),f=c.offset().top,i.css("cursor","x"==l?"ew-resize":"ns-resize"),"y"==l?(a.css("border-right",0),u.css("border-left",0),u.css("border-top","2px solid #ccc")):a.css("border-top",0),a.is(":hidden")?d.hide():(u.length?a.css("border-"+m[l].cssProp,"1px solid #ccc"):a.css("border-"+m[l].cssProp,"0"),b(void 0!==t?t:a.offset()[m[l].cssProp]))}),u.css("width","auto"),u.css("height","auto"),a.data("splitter",d),a.before(d)})},e.fn.splitter.guid=0}),e("skylark-jsbin-client/chrome/analytics",["skylark-jquery","../jsbin"],function(e,t){var n={track:function(e,t,n){window.ga&&ga("send","event",e,t,n)},experiment:function(e){n.track("experiment",e)},universalEditor:function(e){n.track("menu","universalEditor",e)},library:function(e,t){n.track("menu",e,"library",t)},infocard:function(e,t){n.track("infocard",e,t)},embed:function(){try{n.track("state","embed",window.top.location)}catch(e){n.track("state","embed")}},milestone:function(){n.track("bin","save",window.location.pathname)},clone:function(){n.track("bin","clone",window.location.pathname)},delete:function(){n.track("bin","delete",window.location.pathname)},lock:function(){n.track("bin","lock",window.location.pathname)},openShare:function(){n.track("menu","open","share")},saveTemplate:function(){n.track("menu","select","save-template")},createNew:function(e){n.track(e||"menu","select","new")},open:function(e){n.track(e||"menu","select","open")},openFromAvatar:function(){n.track("menu","select","open via avatar")},openMenu:function(e){n.track("menu","open",e)},closeMenu:function(e){n.track("menu","close",e)},selectMenu:function(e){e&&n.track("menu","select",e)},share:function(e,t){n.track("share",e,t)},download:function(e){n.track(e||"menu","select","download")},showPanel:function(e){n.track("panel","show",e)},hidePanel:function(e){n.track("panel","hide",e)},logout:function(){n.track("menu","select","logout")},register:function(e){void 0===e?n.track("menu","open","login"):n.track("user","register",ok?"success":"fail")},login:function(e){void 0===e?n.track("menu","open","login"):n.track("user","login",e?"success":"fail")},enableLiveJS:function(e){n.track("button","auto-run js",e?"on":"off")},archiveView:function(e){n.track("button","view archive",e?"on":"off")},archive:function(e){n.track("button","archive",e)},unarchive:function(e){n.track("button","unarchive",e)},loadGist:function(e){n.track("state","load gist",e)},layout:function(e){var t=[],i="";for(i in e)t.push(i.id);n.track("layout","update",t.sort().join(",")||"none")},run:function(e){n.track(e||"button","run with js")},publishVanity:function(){n.track("bin","publish-vanity")},runconsole:function(e){n.track(e||"button","run console")},welcomePanelState:function(e){var t="close";e&&(t="open"),n.track("state","welcome-panel",t)},welcomePanelLink:function(e){n.track("welcome-panel-link",e)}};return e('a[data-pro="true"]').on("click",function(){n.track("try-pro",e(this).text())}),t.analytics=n}),e("skylark-jsbin-client/chrome/settings",["skylark-jquery","../jsbin"],function(e,t){}),e("skylark-jsbin-client/render/saved-history-preview",["skylark-jquery","../jsbin"],function(e,t){"use strict";if(t.user&&t.user.name&&!t.embed){var n,i=e("body"),o=!1,s=5;$document.on("history:open",function(){n&&0===t.panels.getVisible().length&&n.appendTo("main")}).on("history:close",function(){null===n&&(n=e("#history").detach())});var a=function(){o||(e("html").hasClass("public-listing")?u():e.ajax({dataType:"html",url:t.root+"/list",error:function(){--s>0?(e("#history").remove(),setTimeout(a,500)):console.error("Giving up to load history")},success:function(n){e("#history").remove();var s=e(n);t.mobile&&s.find("tbody:gt(50)").remove(),i.append(s),u(),o=!0}}))},r=function(e,t){t.attr("src",e+"/quiet"),t.removeAttr("hidden")},c=function(e,t){t.html('<a href="'+e+'">'+e+"</a>")},l=function(t,n){var i=t.parent();t.detach().each(function(){var t=e(this),i=n?".archived":":not(.archived)",o=e("tr"+i,t).filter(":not(.spacer)");o.length>0?(o.filter(".first").removeClass("first"),t.removeClass("hidden"),o.first().addClass("first")):t.addClass("hidden")}).appendTo(i)},u=function(){if(!(n=e("#history").detach()).length)return n;var i=e("iframe",n),o=e("#viewing",n),s=n,a=e("tbody",n),u=e("tr",n),d=e(".toggle_archive",n);s.delegate(".archive, .unarchive","click",function(){var i=e(this),o=i.parents("tr");return o.toggleClass("archived"),analytics[-1===this.pathname.indexOf("unarchive")?"archive":"unarchive"](t.root+o.data("url")),l(a,n.hasClass("archive_mode")),e.ajax({type:"POST",url:i.attr("href"),error:function(){alert("Something went wrong, please try again"),o.toggleClass("archived"),l(a,n.hasClass("archive_mode"))},success:function(){}}),!1}),d.change(function(){n.toggleClass("archive_mode");var e=n.hasClass("archive_mode");analytics.archiveView(e),l(a,e)});var p=null;return s.delegate("a","click",function(n){if(!n.shiftKey&&!n.metaKey){var s=e(this);if(!s.closest(".action").length)if(n.preventDefault(),n.stopImmediatePropagation(),"history"!==s.data("toggle")){var a=s.closest("tr"),l=a.data(),d=t.root+l.url;p===this?window.location=l.editUrl:(u.removeClass("selected"),a.addClass("selected"),r(d,i),c(d,o),p=this)}else t.panels.allEditors(function(e){e.editor.getCode().trim().length&&e.show()})}}),s.delegate("tr:not(.spacer)","click",function(t){t.shiftKey||t.metaKey||e(this).find(".url a:first").click()}),e("a[pubdate]",n).attr("pubdate",function(e,t){return t.replace("Z","+0000")}).prettyDate(),setTimeout(function(){l(a,!1)},0),$document.trigger("history:open"),n};return e(document).on("jsbinReady",function(){if(!t.embed){var n=e("#panels a"),o=e(".homebtn"),s=i.hasClass("panelsVisible");o.on("click",a),n.on("mousedown",function(){1===n.filter(".active").length&&e(this).hasClass("active")&&a()}),$document.on("history:load",a),s||a()}}),{loadList:a,updatePreview:r,updateViewing:c,updateLayout:l,hookUserHistory:u}}}),e("skylark-jsbin-client/chrome/esc",["skylark-jquery","../jsbin"],function(e,t){var n=!1,i=!1,o=!1,s=!1,a=!1,r=!1;function c(){r&&(e("#infocard").removeClass("open"),r=!1),a&&($body.removeClass("show-nav"),a=!1),s?($body.removeClass("urlHelp"),s=!1,analytics.closeMenu("help")):o?($body.removeClass("keyboardHelp"),o=!1,analytics.closeMenu("keyboardHelp")):i?closedropdown():n&&(e("#login").hide(),analytics.closeMenu("login"),n=!1)}t.$document.keydown(function(e){27==e.which&&c()}),t.$document.delegate(".modal","click",function(t){e(t.target).is(".modal")&&c()})}),e("skylark-jsbin-client/chrome/share",["skylark-jquery","../jsbin"],function(e,t){"use strict";if(0!==e("#sharemenu .share-split").length){var n={live:"output",javascript:"js"},i=e('#sharepanels input[type="checkbox"]'),o=t.state.revision;$document.on("saved",function(){o=t.state.revision}),$document.on("snapshot",function(){t.state.changed=!1,window.history.replaceState&&window.history.replaceState(null,"",t.getURL({withRevision:!0})+"/edit?"+panels.getQuery())});var s=e("#sharemenu").bind("open",function(){i.prop("checked",!1),t.panels.getVisible().forEach(function(e){i.filter('[value="'+(n[e.id]||e.id)+'"]').prop("checked",!0)}),t.state.latest?(t.state.checksum?(r.prop("checked",t.state.latest),c.prop("checked",!1),f.show()):(r.prop({checked:!1}),c.prop("checked",!0),f.hide()),m.show()):(r.prop({checked:!1,disabled:!0}),c.prop("checked",!0),m.hide()),y()});s.find(".lockrevision").on("change",function(){saveChecksum=!1,t.state.checksum=!1,$document.trigger("locked")});var a=e("#share-preview"),r=e('#sharebintype input[type=radio][value="realtime"]'),c=e('#sharebintype input[type=radio][value="snapshot"]'),l=s.find("a.link")[0],u=s.find('input[name="url"]')[0],d=s.find("textarea")[0],p=s.find("form")[0],h=s.find(".direct-links"),f=e("#andlive"),m=s.find(".codecasting");e("#sharebintype input[type=radio]").on("change",function(){"snapshot"===this.value?(t.state.checksum=!1,saveChecksum=!1,m.hide()):m.show()}),s.find("input").on("change",y),$document.on("saved",function(){r.prop("checked",!0),s.removeClass("hidden"),y()});var g=e("#share").closest(".menu"),v=e("#sharemenu a")[0],b=e("a.show-share").on("click",function(){g.hasClass("open")?closedropdown(v):opendropdown(v,!0),b.blur()})}function y(){var e=function(e){for(var t,n,i,o,s=e.length,a={},r=function(e,t,n){void 0===e[t]?e[t]=n:("string"==typeof e[t]&&(e[t]=[e[t]]),e[t].push(n))},c=0;c<s;c++)n=e[c],t=n.value,i=n.type,o=n.name,"radio"===i?n.checked&&r(a,o,t):"checkbox"===i?(void 0===a[o]&&(a[o]=[]),n.checked&&r(a,o,t)):r(a,o,t);return a}(p),n=t.getURL({root:t.shareRoot}),s=t.getURL();"snapshot"===e.state&&t.state.latest&&(n+="/"+o,s+="/"+o);var r=n,c=e.panel.join(",");c&&(c="?"+c),i.prop("disabled","output"===e.view),a.attr("class",e.view),"output"!==e.view&&a.find(".editor div").each(function(){this.hidden=-1===e.panel.indexOf(this.className)}),"editor"===e.view?r+="/edit":c="",h.empty();var f=[],m="",g="";if((m=t.panels.panels.html.getCode().trim())&&("html"!==(g=processors[t.state.processors.html||"html"].extensions[0])?f.push('<a target="_blank" href="'+n+"."+g+'">'+g+"</a>"):0===m.toLowerCase().indexOf("<svg")&&f.push('<a target="_blank" href="'+n+'.svg">svg</a>')),t.panels.panels.css.getCode().trim()&&("css"!==(g=processors[t.state.processors.css||"css"].extensions[0])&&f.push('<a target="_blank" href="'+n+'.css">css</a>'),f.push('<a target="_blank" href="'+n+"."+g+'">'+g+"</a>")),m=t.panels.panels.javascript.getCode().trim()){"js"!==(g=processors[t.state.processors.javascript||"javascript"].extensions[0])&&f.push('<a target="_blank" href="'+n+'.js">js</a>');try{JSON.parse(m),f.push('<a target="_blank" href="'+n+'.json">json</a>')}catch(e){f.push('<a target="_blank" href="'+n+"."+g+'">'+g+"</a>")}}h.html(f.join("")),u.value=l.href=r+c,d.value=('<a class="jsbin-embed" href="'+s+"/embed"+c+'">'+documentTitle+' on jsbin.com</a><script src="'+t.static+"/js/embed.min.js?"+t.version+'"><\/script>').replace(/<>"&/g,function(e){return{"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;"}[e]})}}),e("skylark-jsbin-client/chrome/issue",["skylark-jquery","../jsbin"],function(e,t){"use strict";function n(){var e=["Please provide any additional information, record a screencast ","with http://quickcast.io or http://screenr.com and attach a screenshot ","if possible.\n\n**JS Bin info**\n\n* [%url%/edit](%url%/edit)\n* ",window.navigator.userAgent+"\n",t.user&&t.user.name?"* "+t.user.name:"","\n"].join("");return"http://github.com/jsbin/jsbin/issues/new?body="+encodeURIComponent(e.replace(/%url%/g,t.getURL({withRevision:!0})))}var i=e("#newissue");return e("#help").parent().on("open",function(){i.attr("href",n())}),n}),e("skylark-jsbin-client/chrome/download",["skylark-jquery","../jsbin","./analytics"],function(e,t,n){e("#download").click(function(e){e.preventDefault(),window.location=t.getURL({withRevision:!0})+"/download",n.download()})}),e("skylark-jsbin-client/chrome/login",["skylark-jquery","../jsbin"],function(e,t){e("form.login").submit(function(t){"use strict";t.preventDefault();var n=e(this),i=n.find("input[name=username]").val(),o=n.find("input[name=password]").val(),s=n.find("input[name=email]").val(),a=n.find(".loginFeedback");a.show().text("Checking..."),e.ajax({url:n.attr("action"),data:{username:i,key:o,email:s},type:"POST",dataType:"json",complete:function(t){var n=e.parseJSON(t.responseText)||{};200===t.status?(n.avatar&&e("a.avatar").find("img").remove().end().prepend('<img src="'+n.avatar+'">'),n.message?a.text(n.message):window.location=window.location.pathname+window.location.search):(analytics.login(!1),a.text(n.message||'"'+i+'" has already been taken. Please either double check the password, or choose another username.'))}})})}),e("skylark-jsbin-client/chrome/tips",["skylark-jquery","../jsbin"],function(e,t){var n,i=e(document.documentElement),o=e("#tip"),s=e("p",o),a=function(t){i.removeClass("showtip"),o.removeClass(),s.html(""),e(window).resize(),t&&setTimeout(t,0)},r=function(e){clearTimeout(n),s.html(e.content),o.removeClass().addClass(e.type||"info"),i.addClass("showtip"),e.autohide&&(n=setTimeout(function(){a()},parseInt(e.autohide,10)||5e3))};t.$document.on("tip",function(e,t){var n=t;if("string"==typeof t&&((n={}).content=t,n.type="info"),s.html()===n.content&&o.hasClass(n.type))return r(t);a(function(){r(n)})}),e("#tip").on("click","a.dismiss",function(){return a(),!1}),t.$document.keydown(function(e){27==e.which&&a()})}),e("skylark-jsbin-client/chrome/keys",["skylark-jquery","../jsbin"],function(e,t){"use strict";if(!t.user||!t.user.name){var n={},i=function(e){var i=n[e||t.getURL({withRevision:!0,withoutRoot:!0})]||{};return i.c};try{"localStorage"in window&&window.localStorage}catch(e){return i}return $document.on("saved",function(){n[t.getURL({withRevision:!1,withoutRoot:!0})]={s:t.state.revsion,c:t.state.checksum,d:(new Date).getTime()},localStorage.keys=JSON.stringify(n)}),window.addEventListener("storage",function(e){"keys"===e.key&&o()}),o(),t.keys=i}function o(){n=JSON.parse(localStorage.keys||"{}")}}),e("skylark-jsbin-client/chrome/save",["../jsbin"],function(e){var t={todo:{html:!1,css:!1,javascript:!1},_inprogress:!1,inprogress:function(e){if(void 0===e)return t._inprogress;if(t._inprogress=e,!1===e){var n=["html","css","javascript"],i=function(){var e=n.pop();e&&t.todo[e]?(t._inprogress=!0,h(e,i),t.todo[e]=!1):e&&i()};i()}}};function n(t){var i=e.panels.panels.html.getCode(),o="";return-1===i.indexOf("<"+t)?o:"title"!==t&&"meta"!==t?(console.error("getTagContent for "+t+" is not supported"),o):(i.replace(n.re[t],function(e,n,i){o="title"===t?n:i}),o)}n.re={meta:/(<meta name="description" content=")([^"]*)/im,title:/<title>(.*)<\/title>/im},$("a.save").click(function(t){t.preventDefault(),analytics.milestone();var n=!0;return!0===e.saveDisabled&&(n=!1),(e.state.changed||e.mobile||!e.owner())&&g("save",n),!1});var i=$("#share .link"),o=$("#sharemenu #sharepanels input"),s=$("#sharemenu .share-split").length;function a(){"use strict";if(!s){var t={live:"output",javascript:"js",css:"css",html:"html",console:"console"},n=o.filter(":checked").map(function(){return t[this.getAttribute("data-panel")]}).get().join(",");i.each(function(){var t=this.getAttribute("data-path"),i=e.getURL({withRevision:!0})+t+(n&&"livepreview"!==this.id?"?"+n:""),o=this.nodeName,s=panels.getHighlightLines();s&&(s="#"+s),"A"===o?this.href=i:"INPUT"===o?(this.value=i,"/edit"===t&&(this.value+=s)):"TEXTAREA"===o&&(this.value=('<a class="jsbin-embed" href="'+i+s+'">'+documentTitle+'</a><script src="'+e.static+'/js/embed.js"><\/script>').replace(/<>"&/g,function(e){return{"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;"}[e]}))})}}$("#sharemenu").bind("open",a),$("#sharebintype input[type=radio]").on("click",function(){"snapshot"===this.value&&(e.state.checksum=!1,l=!1),a()});var r=null;function c(t,i){if(!i||"html"===i.panelId){var o=e.panels.panels.html.getCode();if(r!==o){r=o;var s=n("meta");s!==e.state.description&&(e.state.description=s,e.state.updateSettings({description:s}));var a=n("title");a!==e.state.title&&(e.state.title=a,e.state.updateSettings({title:a}),documentTitle=a,documentTitle?document.title=documentTitle+" - "+e.name:document.title=e.name)}}}$document.on("saveComplete",c),$document.on("saved",function(){e.state.changed=!1,a(),$('#sharebintype input[type=radio][value="realtime"]').prop("checked",!0),i.closest(".menu").removeClass("hidden"),$("#jsbinurl").attr("href",e.getURL()).removeClass("hidden"),$("#clone").removeClass("hidden"),c()});var l=e.state.checksum||store.sessionStorage.getItem("checksum")||!1;function u(e,t){413===e.status?($("#tip p").html("Sorry this bin is too large for us to save"),$(document.documentElement).addClass("showtip")):403===e.status?$document.trigger("tip",{type:"error",content:"I think there's something wrong with your session and I'm unable to save. <a href=\""+window.location+'"><strong>Refresh to fix this</strong></a>, you <strong>will not</strong> lose your code.'}):t&&(t&&d[t].text("Saving...").animate({opacity:1},100),window._console.error({message:"Warning: Something went wrong while saving. Your most recent work is not saved."}))}if(e.state.checksum=l,l?$("#share div.disabled").removeClass("disabled").unbind("click mousedown mouseup"):$("#share div.disabled").one("click",function(e){e.preventDefault(),$("a.save").click()}),$document.one("saved",function(){$("#share div.disabled").removeClass("disabled").unbind("click mousedown mouseup")}),e.saveDisabled)$document.one("jsbinReady",function(){"use strict";var t=!1;e.embed||e.sandbox||$document.on("codeChange.live",function(n,i){if(!i.onload&&!t&&"setValue"!==i.origin){t=!0;var o=-1!==navigator.userAgent.indexOf(" Mac "),s=o?"⌘":"ctrl",a=o?"⇧":"shift",r=o?"":"+";$document.trigger("tip",{type:"notification",content:'You\'re currently viewing someone else\'s live stream, but you can <strong><a class="clone" href="'+e.root+'/clone">clone your own copy</a></strong> ('+s+r+a+r+"S) at any time to save your edits"})}})});else{$(".code.panel .label .name").append('<span class="saved">Saved</span>');var d={html:$(".panel.html .name span.saved"),javascript:$(".panel.javascript .name span.saved"),css:$(".panel.css .name span.saved")};$document.bind("jsbinReady",function(){e.state.changed=!1,e.panels.allEditors(function(t){t.on("processor",function(){e.root!==e.getURL()&&$document.trigger("codeChange",[{panelId:t.id}])})}),$document.bind("codeChange",function(t,n){e.state.changed=!0,d[n.panelId]&&d[n.panelId].css({opacity:0}).stop(!0,!0)}),$document.bind("saveComplete",throttle(function(e,t){d[t.panelId].text("Saved").stop(!0,!0).animate({opacity:1},100).delay(1200).animate({opacity:0},500)},500)),$document.bind("codeChange",throttle(function(n,i){if(i.panelId&&!e.state.deleted){var o=i.panelId;e.panels.savecontent(),t.inprogress()?t.todo[o]=!0:(t.inprogress(!0),l&&e.state.code?h(o):g("save",!0))}},3e4))})}function p(e,t){t.compressed=e,e.split(",").forEach(function(e){t[e]=LZString.compressToUTF16(t[e])})}function h(n,i){var o={};e.state.processors&&(o.processors=e.state.processors);var s={code:e.state.code,revision:e.state.revision,method:"update",panel:n,content:editors[n].getCode(),checksum:l,settings:JSON.stringify(o)};e.settings.useCompression&&"http:"===location.protocol&&p("content",s),e.state.processors[n]&&e.state.processors[n]!==n&&e.state.cache[n]&&(s.processed=e.state.cache[n].result),$.ajax({url:e.getURL({withRevision:!0})+"/save",data:s,type:"post",dataType:"json",headers:{Accept:"application/json"},success:function(t){$document.trigger("saveComplete",{panelId:n}),t.error?g("save",!0,function(){}):e.state.latest=!0},error:function(e){u(e,n)},complete:function(){t.inprogress(!1),i&&i()}})}function f(t){t.preventDefault(),e.panels.save(),analytics.clone();var n=m("save,new");return n.submit(),!1}function m(t){var n=$("form#saveform").empty().append('<input type="hidden" name="javascript" />').append('<input type="hidden" name="html" />').append('<input type="hidden" name="css" />').append('<input type="hidden" name="method" />').append('<input type="hidden" name="_csrf" value="'+e.state.token+'" />').append('<input type="hidden" name="settings" />').append('<input type="hidden" name="checksum" />'),i={};return e.state.processors&&(i.processors=e.state.processors),"welcome"===e.state.code&&n.attr("action","/save"),n.find("input[name=settings]").val(JSON.stringify(i)),n.find("input[name=javascript]").val(editors.javascript.getCode()),n.find("input[name=css]").val(editors.css.getCode()),n.find("input[name=html]").val(editors.html.getCode()),n.find("input[name=method]").val(t),n.find("input[name=checksum]").val(e.state.checksum),n}function g(n,i,o){var a=m(n);e.panels.save(),e.panels.saveOnExit=!0;var r=a.serializeArray().reduce(function(e,t){return e[t.name]=t.value,e},{});e.settings.useCompression&&p("html,css,javascript",r),i?$.ajax({url:e.getURL({withRevision:!0})+"/save",data:r,dataType:"json",type:"post",headers:{Accept:"application/json"},success:function(t){if(o&&o(t),store.sessionStorage.setItem("checksum",t.checksum),l=t.checksum,e.state.checksum=l,e.state.code=t.code,e.state.revision=t.revision,e.state.latest=!0,e.state.metadata={name:e.user.name},a.attr("action",e.getURL({withRevision:!0})+"/save"),window.history&&window.history.pushState){var n=panels.getHighlightLines();n&&(n="#"+n);var i=panels.getQuery();i&&(i="?"+i),window.history.pushState(null,"",e.getURL({withRevision:!s})+"/edit"+i+n),store.sessionStorage.setItem("url",e.getURL({withRevision:!s}))}else window.location.hash=t.edit;$document.trigger("saved")},error:function(e){u(e,null)},complete:function(){t.inprogress(!1)}}):a.submit()}$("a.clone").click(f),$("#tip").delegate("a.clone","click",f)}),e("skylark-jsbin-client/chrome/navigation",["skylark-jquery","../jsbin"],function(e,t){e("a.startingpoint").click(function(e){return e.preventDefault(),localStorage?(analytics.saveTemplate(),localStorage.setItem("saved-javascript",editors.javascript.getCode()),localStorage.setItem("saved-html",editors.html.getCode()),localStorage.setItem("saved-css",editors.css.getCode()),localStorage.setItem("saved-processors",JSON.stringify({javascript:t.panels.panels.javascript.processor.id,html:t.panels.panels.html.processor.id,css:t.panels.panels.css.processor.id})),$document.trigger("tip",{type:"notification",content:"Starting template updated and saved",autohide:3e3})):$document.trigger("tip",{type:"error",content:"Saving templates isn't supported in this browser I'm afraid. Sorry"}),!1});e("a.disabled").on("click mousedown mouseup",function(e){return e.stopImmediatePropagation(),!1}),e("#loginbtn").click(function(){analytics.login(),e(this).toggleClass("open")}),e("a.logout").click(function(t){for(t.preventDefault(),e(this.hash).submit(),i=0;i<store.sessionStorage.length;i++)key=store.sessionStorage.key(i),0===key.indexOf("jsbin.content.")&&store.sessionStorage.removeItem(key)}),e(".homebtn").click(function(n,i){return"avatar"===this.id?analytics.openFromAvatar():"profile"===this.id?(analytics.openFromAvatar(),e(this).closest(".open").removeClass("open")):analytics.open(i),hideOpen(),t.panels.hideAll(),!1});var n=e("div.lockrevision").on("click",function(e){e.preventDefault(),saveChecksum=!1,$document.trigger("locked")}).on("mouseup",function(){return!1});if($document.on("locked",function(){n.data("locked")||(analytics.lock(),n.removeClass("icon-unlocked").addClass("icon-lock"),n.html("<span>This bin is now locked from further changes</span>"),n.data("locked",!0))}),$document.on("saved",function(){n.removeClass("icon-lock").addClass("icon-unlocked").data("locked",!1),n.html("<span>Click to lock and prevent further changes</span>")}),!e("#sharemenu .share-split").length){var o=e('#sharepanels input[type="checkbox"]').on("change",function(){updateSavedState()});e("#sharemenu").bind("open",function(){o.attr("checked",!1),t.panels.getVisible().forEach(function(e){o.filter('[data-panel="'+e.id+'"]').prop("checked",!0).change()})})}var s=!1,a=!1;function r(){if(a=!1,s){c.closest(".menu").removeClass("open").trigger("close"),s=!1,!1;var e=t.panels.focused;e&&!t.mobile&&(e.focus(),e.editor&&e.editor.focus())}}var c=e(".button-dropdown, .button-open").mousedown(function(n){return d.removeClass("hover"),s&&s!==this&&r(),s||(a=!0,function(n,i){var o;if(!s){o=e(n).closest(".menu").addClass("open").trigger("open"),analytics.openMenu(n.hash.substring(1));var a=o.find(":text:visible:first");a.length&&!t.mobile&&(a.focus(),setTimeout(function(){a[0].select()},0)),s=n}}(this)),n.preventDefault(),!1}).mouseup(function(){if(a)return!1}).click(function(){return a||(analytics.closeMenu(this.hash.substring(1)),r()),a?(e(this.hash).attr("tabindex",0),a=!1,t.mobile):(a=!1,e(this.hash).attr("tabindex",-1),!1)});e("#actionmenu").click(function(){s=!0});var l=!1;$body.bind("mousedown",function(t){s&&e(t.target).closest(".menu").length&&(l=!0)}).bind("click mouseup",function(t){if(s&&!l&&!e(t.target).closest(".menu").length)return r(),!1;l=!1});var u=!1,d=e(".dropdownmenu a, .dropdownmenu .button").mouseup(function(t){"INPUT"!==t.target.nodeName&&(setTimeout(r,0),analytics.selectMenu(this.getAttribute("data-label")||this.hash.substring(1)||this.href),u||(this.hostname===window.location.hostname?!1!==e(this).triggerHandler("click")&&(window.location=this.href):this.getAttribute("target")?window.open(this.href):window.location=this.href),u=!1)}).mouseover(function(){d.removeClass("hover"),e(this).addClass("hover")}).mousedown(function(e){"INPUT"!==e.target.nodeName&&(u=!0)});e("#jsbinurl").click(function(e){setTimeout(function(){t.panels.panels.live.hide()},0)}),e("#runwithalerts, li.run-with-js a").click(function(e,t){return analytics.run(t),editors.console.visible?editors.console.render(!0):renderLivePreview(!0),!1}),e("#runconsole").click(function(){return analytics.runconsole(),editors.console.render(!0),!1}),e("#clearconsole").click(function(){return jsconsole.clear(),!1}),e("#showhelp").click(function(){return $body.toggleClass("keyboardHelp"),keyboardHelpVisible=$body.is(".keyboardHelp"),keyboardHelpVisible,!1}),e("a.toggle-side-nav").on(t.mobile?"touchstart":"click",function(){return $body.toggleClass("show-nav"),sideNavVisible=$body.is(".show-nav"),sideNavVisible||t.mobile||e("#skipToEditor").click(),sideNavVisible}),e("#showurls").click(function(){return $body.toggleClass("urlHelp"),urlHelpVisible=$body.is(".urlHelp"),urlHelpVisible,!1}),e(".code.panel > .label > span.name").dblclick(function(){t.panels.allEditors(function(e){var n=!e.editor.getOption("lineNumbers");e.editor.setOption("lineNumbers",n),t.settings.editor.lineNumbers=n})}),e("a.createnew").click(function(e){var n,i;for(e.preventDefault(),analytics.createNew(),t.panels.savecontent=function(){},n=0;n<store.sessionStorage.length;n++)0===(i=store.sessionStorage.key(n)).indexOf("jsbin.content.")&&store.sessionStorage.removeItem(i);store.sessionStorage.removeItem("checksum"),t.panels.saveOnExit=!1,t.panels.restore(),setTimeout(function(){0===t.panels.getVisible().length&&(t.panels.panels.html.show(),t.panels.panels.live.show()),window.location=t.root},0)});var p=e("#control a.visibilityToggle#private"),h=e("#control a.visibilityToggle#public"),f=e("#control a.visibilityToggle").click(function(n){n.preventDefault();var i=e(this).data("vis");e.ajax({url:t.getURL({withRevision:!0})+"/"+i,type:"post",success:function(e){$document.trigger("tip",{type:"notification",content:"This bin is now "+i,autohide:6e3}),f.css("display","none"),"public"===i?p.css("display","block"):h.css("display","block")}})});e("form.login").closest(".menu").bind("close",function(){e(this).find(".loginFeedback").empty().hide(),e("#login").removeClass("forgot")}),e("#lostpass").click(function(t){return e("#login").addClass("forgot").find("input[name=email]").focus(),!1}),t.settings.includejs=void 0===t.settings.includejs||t.settings.includejs,!t.embed&&store.sessionStorage.getItem("runnerPending")&&($document.trigger("tip",{content:'It looks like your last session may have crashed, so I\'ve disabled "Auto-run JS" for you',type:"error"}),store.sessionStorage.removeItem("runnerPending"),t.settings.includejs=!1),e("#enablejs").change(function(){t.settings.includejs=this.checked,analytics.enableLiveJS(t.settings.includejs),editors.live.render()}).attr("checked",t.settings.includejs),!t.embed&&t.settings.hideheader&&$body.addClass("hideheader");var m=!1;e("form input, form textarea").focus(function(){this.select(),m=!0}).mouseup(function(){if(m)return m=!1,!1}),window.location.hash&&e('a[href$="'+window.location.hash+'"]').mousedown();var g=-1!==navigator.userAgent.indexOf(" Mac "),v={ctrl:"⌘",shift:"⇧",del:"⌫"};e("#control").find("a[data-shortcut]").each(function(){var t=e(this),n=t.data(),i=n.shortcut;g&&(i=i.replace(/ctrl/i,v.ctrl).replace(/shift/,v.shift).replace(/del/,v.del).replace(/\+/g,"").toUpperCase()),t.append('<span class="keyshortcut">'+i+"</span>")}),function(){var n={head:/<head(.*)\n/i,meta:/<meta name="description".*?>/i,metaContent:/content=".*?"/i},i='<meta name="description" content="[add your bin description]">\n';e("#addmeta").click(function(){var e=t.panels.panels.html,o=e.editor,s=e.getCode();e.visible||e.show(),n.meta.test(s)||(s=n.head.test(s)?s.replace(n.head,"<head$1\n"+i):i+s),e.setCode(s);var a=o.getSearchCursor(n.meta);a.findNext();var r=o.getSearchCursor(n.metaContent);r.findNext();var c={line:a.pos.from.line,ch:a.pos.from.ch+'<meta name="description" content="'.length},l={line:r.pos.to.line,ch:r.pos.to.ch-1};o.setCursor(c),o.setSelection(c,l),o.on("cursoractivity",function(){o.on("cursoractivity",null),u.clear()});var u=o.markText(c,l,{className:"highlight"});return o.focus(),!1}),e("a.publish-to-vanity").on("click",function(n){n.preventDefault(),analytics.publishVanity(),e.ajax({type:"post",url:this.href,data:{url:t.getURL({withRevision:!0})},success:function(){$document.trigger("tip",{type:"notification",content:'This bin is now published to your vanity URL: <a target="_blank" href="'+t.shareRoot+'">'+t.shareRoot+"</a>"})},error:function(e){$document.trigger("tip",{type:"error",content:'There was a problem publishing to your vanity URL. Can you try again or file a <a target="_blank" href="'+githubIssue()+'">new issue</a>?'})}})}),$document.on("click","a.deleteallbins",function(){t.user&&t.state.metadata.name===t.user.name?confirm("Delete all snapshots of this bin including this one?")&&(analytics.deleteAll(),e.ajax({type:"post",url:t.getURL()+"/delete-all",success:function(){t.state.deleted=!0,$document.trigger("tip",{type:"error",content:"This bin and history is now deleted. You can continue to edit, but once you leave the bin can't be retrieved"})},error:function(e){403===e.status&&$document.trigger("tip",{content:"You don't own this bin, so you can't delete it.",autohide:5e3})}})):$document.trigger("tip",{type:"error",content:'You must be logged in <em><strong>the bin owner</strong></em> to delete all snapshots. <a target="_blank" href="/help/delete-a-bin">Need help?</a>'})}),e("a.deletebin").on("click",function(n){n.preventDefault(),confirm("Delete this bin?")&&(analytics.delete(),e.ajax({type:"post",url:t.getURL({withRevision:!0})+"/delete",data:{checksum:t.state.checksum},success:function(){t.state.deleted=!0,$document.trigger("tip",{type:"error",content:"This bin is now deleted. You can continue to edit, but once you leave the bin can't be retrieved"})},error:function(e){403===e.status&&$document.trigger("tip",{content:"You don't own this bin, so you can't delete it.",autohide:5e3})}}))}),e("a.archivebin").on("click",function(e){e.preventDefault(),archive()}),e("a.unarchivebin").on("click",function(e){e.preventDefault(),archive(!1)});var o=e("#enableUniversalEditor").on("change",function(e){e.preventDefault(),t.settings.editor.simple=this.checked,analytics.universalEditor(t.settings.editor.simple),settings.save(function(){window.location.reload()})});t.settings.editor.simple&&o.prop("checked",!0),e("#skipToEditor").on("click keypress",function(){var n=(t.panels.getVisible()||["html"]).shift();return t.settings.editor.simple||t.mobile?e("#"+n.id).focus():n?n.editor.focus():t.panels.panels.html.editor.focus(),!1})}()}),e("skylark-jsbin-client/chrome/file-drop",["skylark-jquery","../jsbin"],function(e,t){window.File&&window.FileList&&window.FileReader&&function(n){var i=null,o=null,s=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return e()+e()}}();function a(n){var s=document.createElement("div");s.className="assetLoading",s.innerHTML="0% uploading...";var a=0,l=null,u=i||o.getCursor();if(t.lameEditor)r(o,"Uploading ...",!0);else{var d=i?i.line:o.getCursor().line;l=o.addLineWidget(d,s,{coverGutter:!1,nohscroll:!0})}new S3Upload({s3_sign_put_url:"/account/assets/sign",s3_object_name:n.name.replace(/\s+/g,"-"),files:[n],onProgress:function(e,n){t.lameEditor||requestAnimationFrame(function(){!function e(t,n){t-a<10?a=t:(a+=10,requestAnimationFrame(function(){e(t,n)}));s&&a>0&&(s.innerHTML=a>97?"97% uploaded...":a+"% uploaded...")}(e,n)})},onError:function(e,t){a=-1,console.error("Failed to upload: "+t),s.innerHTML=t||"Failed to complete",s.style.color="red",o=null,i=null,l&&setTimeout(function(){l.clear()},4e3)},onFinishS3Put:function(s){t.lameEditor?(r(o,c(n.type,o,s)),e(document).trigger("codeChange",{panelId:o.id})):(l.clear(),o.replaceRange(c(n.type,o,s),u)),o=null,i=null}})}function r(e,t,n){var i=e.selectionStart,o=e.selectionEnd,s=e,a=s.value;s.value=a.substring(0,i)+t+a.substring(o),e.selectionStart=e.selectionEnd=i+1,n?(e.selectionStart-=1,e.selectionEnd=e.selectionEnd+t.length):e.selectionStart=e.selectionEnd=i+t.length}function c(e,n,i){var o=t.state.processors[n.id];return"html"===n.id?0===e.indexOf("image/")?"markdown"===o?"!["+i+"]("+i+")":"jade"===o?'img(src="'+i+'")':'<img src="'+i+'">':i:"css"===n.id&&0===e.indexOf("image/")?"url("+i+")":i}var l=!1;function u(e){return new Promise(function(t,n){"string"===e.kind?e.getAsString(function(e){t(e)}):t(e.getAsFile())})}n.ondragover=function(){return l=!0,!1},n.ondragend=function(){return l=!1,!1},e("#bin textarea").on("paste",function(t){o=e(this).closest(".CodeMirror").length?e(this).closest(".CodeMirror")[0].CodeMirror:this;var n=t.originalEvent,i=n.clipboardData.items;if(i&&0!==n.clipboardData.types[0].indexOf("text/")){for(var r=[],c=0;c<i.length;c++)r.push(u(i[c]));Promise.all(r).then(function(e){e.sort(function(e,t){return"string"==typeof e?1:-1});var t=e[0];t.name=e[1]||s()+"."+t.type.split("/")[1],a(t)}).catch(function(e){console.log(e.stack)}),t.preventDefault()}}),e(".CodeMirror").on("mousemove",function(e){l&&(o=this.CodeMirror,i=this.CodeMirror.coordsChar({top:event.y,left:event.x}),this.CodeMirror.setCursor(i))});var d=["javascript","coffeescript","coffee","js"],p=["css","less","sass","scss"],h=["html","markdown","plain"];n.ondrop=function(n){l=!1,n.preventDefault(),o=e(n.target).closest(".CodeMirror").length?e(n.target).closest(".CodeMirror")[0].CodeMirror:n.target;var i=n.dataTransfer.files[0],s=new FileReader;if(0===i.type.indexOf("text/"))return s.onload=function(e){var n=i.type?i.type.toLowerCase().replace(/^(text|application)\//,""):i.name.toLowerCase().replace(/.*\./g,""),o=null,s=editors[o],r=(e.target.result,null);if(-1!==d.indexOf(n)?o="javascript":-1!==p.indexOf(n)?o="css":-1!==h.indexOf(n)&&(o="html"),null===o)return a(i);s=editors[o],r=s.editor.scroller,s.setCode(e.target.result),s.show();try{var c=new Worker(t.static+"/js/editors/sync-worker.js");c.postMessage(i),s.$el.find("> .label").append("<small> (live: edit & save in your fav editor)</small>"),c.onmessage=function(e){var t=r.scrollTop;s.setCode(e.data.body),r.scrollTop=t,e.data.body}}catch(e){}},s.readAsText(i),!1;a(i)}}(document.body)}),e("skylark-jsbin-client/chrome/gist",["skylark-jquery","skylark-jsbin-coder/editors/panels","../jsbin"],function(e,t,n){"use strict";var i=!!("withCredentials"in new XMLHttpRequest||"undefined"!=typeof XDomainRequest);if(!i)return e(function(){e("#export-as-gist").remove()});var o=function(t){var i=this,o="";return i.code={},n.user&&n.user.github_token&&(o="?access_token="+n.user.github_token),e.get("https://api.github.com/gists/"+t+o,function(t){t&&(e.each(t.files,function(e,t){var n=e.split(".").slice(-1).join("");i.code[n]=t.content}),i.setCode())}),this};return o.prototype.setCode=function(){e.each(this.code,function(e,i){var o=n.processors.findByExtension(e),s=o.target||o.id,a=t.named[s];a&&(processors.set(s,o.id),n.saveDisabled=!0,a.setCode(i),n.saveDisabled=!1)})},e("a.export-as-gist").click(function(){var t={public:!0,files:{}},i={html:i.named.html.render(),javascript:i.named.javascript.render(),css:i.named.css.render()};return Promise.all(i).then(function(i){Object.keys(i).forEach(function(e){var o=processors[e].extensions?processors[e].extensions[0]:e,s=["jsbin",n.state.code||"untitled",o].join(".");i[e].length&&(t.files[s]={content:i[e]})}),t.files.javascript||t.files.css||delete t.files[["jsbin",n.state.code||"untitled","html"].join(".")],n.state.processors&&(i.source=n.state.processors,Object.keys(i.source).forEach(function(e){i.source[e]=n.panels.panels[e].getCode()}));var o=binToFile(i);t.files["index.html"]={content:o};var s=[];n.state.title&&s.push(n.state.title),n.state.description&&s.push(n.state.description),s.push("// source "+n.getURL()),t.description=s.join("\n\n");var a="";n.user&&n.user.github_token&&(a="?access_token="+n.user.github_token),e.ajax({type:"POST",url:"https://api.github.com/gists"+a,data:JSON.stringify(t),dataType:"json",crossDomain:!0,success:function(e){n.$document.trigger("tip",{type:"notification",content:'Gist created! <a href="'+e.html_url+'" target="_blank">Open in new tab.</a>'})},error:function(e,i,o){n.$document.trigger("tip",{type:"error",content:"There was a problem creating the gist: "+o}),console.group("gist"),console.log(t),console.groupEnd("gist")}})},function(e){console.error(e.stack)}),!1}),o}),e("skylark-jsbin-client/chrome/spinner",["skylark-jquery","../jsbin"],function(e,t){return t.spinner=function(e){"use strict";var t=e||document.createElement("canvas");if(!t.getContext)return!1;var n=t.getContext("2d"),i=null;t.height=t.width=11;var o=Math.PI/180,s=t.width,a=t.height,r=0,c=4,l=4,u=1/7;n.strokeStyle="rgba(0,0,0,.5)",n.lineWidth=1.5;var d=!0;return{element:t,start:function e(){i=window.requestAnimationFrame(e);r+=l;var t=r*u%360;var p=r%360;var h=p===t;h&&(d=!d,t-=1);n.fillStyle="#f9f9f9";n.strokeStyle="#111";n.fillRect(s/2-2*c,a/2-2*c,4*c,4*c);n.beginPath();n.arc(s/2+.5,a/2+.5,c,t*o,p*o,d);n.stroke();n.strokeStyle="#999";n.beginPath();n.arc(s/2+.5,a/2+.5,c,p*o,t*o,d);n.stroke();n.closePath()},stop:function(){window.cancelAnimationFrame(i)}}}}),e("skylark-jsbin-client/chrome/infocard",["skylark-jquery","../jsbin"],function(e,t){if("EventSource"in global)return n();function n(){"use strict";if(!t.embed){var n=e("#infocard"),i=n.find("header"),o=i.find("canvas")[0],s=spinner(o),a=t.panels.panels.html,r=0,c=null,l={head:/<head(.*)\n/i,meta:/(<meta name="description" content=")([^"]*)/im,title:/<title>(.*)<\/title>/im};0!==n.length&&(n.find(".settings")&&(n.find("#title").on("input",function(){p("title");var e=a.getCode(),n=this.value,i=e.replace(l.title,function(e,t){return"<title>"+n.replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</title>"});h(i),t.state.updateSettings({title:this.value})}),n.find("#description").on("input",function(){p("meta");var e=a.getCode(),n=this.value,i=e.replace(l.meta,function(e,t){return t+n.replace(/"/g,"&quot;")});h(i),t.state.updateSettings({description:this.value})})),function(){function o(){var i={};n.find(".row").each(function(){e(this).find('[name="header-value"]').val().trim()&&(i[e(this).find("input:first").val()]=e(this).find("input:last").val())}),t.state.updateSettings({headers:i},"PUT")}e("a.more").add(i).on("mousedown touchstart",function(e){var t;infocardVisible=!infocardVisible,hideOpen(),e.preventDefault(),analytics.infocard("click","no-result"),n.toggleClass(function(e,n){return t=-1===n.indexOf("open")?"open":"close",infocardVisible="open"===t,"open"}).trigger(t)}),n.one("open",function(){var n=e("#status").data("status")||200;e.getJSON(t.static+"/js/http-codes.json",function(i){var o="";i.forEach(function(e){o+='<option value="'+e.code+'">'+e.string+"</option>"}),e("#status").html(o).val(n).on("change",function(){t.state.updateSettings({statusCode:this.value})})})}).on("close",function(){});var s=n.find("#headers");n.on("click","#headers button",function(e){e.preventDefault();var t=s.find("span:last");o();var n=t.clone(!0);t.before(n),t.find("input").val("").eq(0).focus()}),n.on("input",".row input",function(){o(e(this).closest(".row"))})}(),f(),$document.bind("saved",f))}function u(e,t){var o=t?JSON.parse(t):JSON.parse(e.data);if(o.connections>0&&0===r&&n.addClass("viewers"),r!==o.connections){var s=i.find(".viewers b").removeClass("up down").html("<b>"+o.connections+"<br>"+r+"<br>"+o.connections+"</b>"),a=r>o.connections?"down":"up";setTimeout(function(){s.addClass(a)},0)}0===(r=o.connections)&&setTimeout(function(){n.removeClass("viewers")},250)}function d(e){window.EventSource&&e&&(c&&c.close(),(c=new EventSource(t.getURL()+"/stats?checksum="+t.state.checksum)).addEventListener("stats",throttle(u,1e3)))}function p(e){a.editor;var n=a.getCode();if("meta"===e&&(e='meta name="description'),-1===n.indexOf("<"+e)){var i=function(e,n){var i=t.state.processors.html;if(n=n.replace(/"/g,"&quot;"),"title"===e)return"jade"===i?"title "+n+"\n":"<title>"+n+"</title>\n";if("description"===e)return"jade"===i?'meta(name="description", content="'+n+'")\n':'<meta name="description" content="'+n+'">\n';return n}("title"===e?"title":"description","");n=l.head.test(n)?n.replace(l.head,"<head$1\n"+i):i+n,a.setCode(n)}}function h(e){var n=null,i=null,o=a.editor,s=o.somethingSelected();t.panels.panels.html.visible&&(s&&(n=o.listSelections()),i=o.getCursor()),a.setCode(e),t.panels.panels.html.visible&&(t.mobile||o.setCursor(i),s&&o.setSelections(n))}function f(o){var a=t.state.metadata||{},r=[],l=!1;if(a.name&&(i.find(".name b").html(a.name),i.find("img").attr("src",a.avatar),r.push(a.name)),(t.state.checksum||t.user&&a.name===t.user.name)&&(l=!0,r.push("author")),s&&s.stop(),t.state.streaming&&!0!==l?!1===l&&(i.find("time").html("Streaming"),r.push("streaming"),s&&s.start()):i.find("time").html(o?"just now":prettyDate(a.last_updated)),t.checksum||r.push("meta"),a.pro&&r.push("pro"),i.find(".visibility").text(a.visibility),"private"===a.visibility?r.push("private"):"public"===a.visibility&&r.push("public"),t.state.code&&n.addClass(r.join(" ")).parent().removeAttr("hidden"),t.state.streaming)if(window.EventSource&&l){d(l),function(e){var t="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"mozHidden"in document?"mozHidden":null;if("visibilityState"in document||("webkitVisibilityState"in document||"mozVisibilityState"in document)){var n=t.replace(/hidden/i,"visibilitychange");document.addEventListener(n,function(){document[t]?c.close():d(e)})}}(l);var p=t.getURL();$document.on("saved",function(){var e=window.location.toString();p!==e&&(c.close(),d(l))})}else!0===t.saveDisabled&&"/edit"===window.location.pathname.slice(-5)&&(e.getScript(t.static+"/js/spike.js?"+t.version),$document.on("stats",throttle(u,1e3)))}}e.getScript(t.static+"/js/vendor/eventsource.js",n)}),e("skylark-jsbin-client/chrome/last-bin",["skylark-jquery","../jsbin"],function(e,t){"use strict";function n(){var e,t=window.location.href;document.cookie=t?"last="+encodeURIComponent(t)+"; expires="+((e=new Date).setTime(+e+36e5),e.toUTCString())+"; path=/":'last=""; expires=-1; path=/'}var i,o;t&&t.getURL?($document.on("saved",n),n()):(i=document.getElementById("back"),o=function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}("last"),i&&null!==o&&"%2Fedit"!==o&&(i.href=decodeURIComponent(o)))}),e("skylark-jsbin-client/chrome/archive",["skylark-jquery","../jsbin","./analytics"],function(e,t,n){function i(){t.state.metadata&&t.state.metadata.archive?(e("a.archivebin").hide(),e("a.unarchivebin").show()):(e("a.archivebin").show(),e("a.unarchivebin").hide())}return i(),t.archive=function(o){"use strict";var s=!1===o?"unarchive":"archive",a=!1===o?"restore from archive":"archiving";n[s](t.getURL({withRevision:!0})),t.user.name?t.owner()?e.ajax({type:"POST",url:t.getURL({withRevision:!0})+"/"+s,error:function(){$document.trigger("tip",{type:"error",content:"The "+a+" failed. If this continues, please can you file an issue?"})},success:function(){t.state.metadata.archive=!1!==o,i(),$document.trigger("tip",{type:"notication",autohide:5e3,content:"This bin is now "+(!1===o?"restored from the archive.":"archived.")})}}):t.$document.trigger("tip",{type:"notication",content:"The "+a+" failed. You can only archive bins that you own."}):t.$document.trigger("tip",{type:"notication",content:"You must be logged in and the owner of the bin to archive."})}}),e("skylark-jsbin-client/chrome/transfer",["skylark-jquery","../jsbin"],function(e,t){var n=e("a.transfer").on("click",function(n){n.preventDefault();var i=prompt("Enter the username to transfer this bin to");(i=(i||"").trim().toLowerCase()).length&&e.ajax({url:t.getURL({withRevision:!0})+"/transfer",method:"post",data:{to:i,_csrf:t.state.token},success:function(){window.location.reload()},error:function(e){console.log(e),403===e.status?alert("This bin cannot be transferred as you do not own it."):400===e.status?alert('The user "'+i+"\" couldn't be found, sorry."):alert("Failed to transfer bin")}})});return function(){t.owner()?n.show():n.hide()}}),e("skylark-jsbin-client/chrome/welcome-panel",["skylark-jquery","../jsbin","./analytics"],function(e,t,n){"use strict";if(e("#toppanel").length){void 0===t.settings.gui&&(t.settings.gui={}),void 0===t.settings.gui.toppanel&&(t.settings.gui.toppanel=!0,store.localStorage.setItem("settings",JSON.stringify(t.settings))),$body.hasClass("toppanel")&&!1===t.settings.gui.toppanel&&($body.addClass("toppanel-close"),$body.removeClass("toppanel")),n.welcomePanelState(t.settings.gui.toppanel);var i=function(e){$body.removeClass("toppanel-slow"),e.shiftKey&&$body.addClass("toppanel-slow")};e(".toppanel-logo").on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(e){$document.trigger("sizeeditors")}),e(".toppanel-hide").click(function(e){e.preventDefault(),i(e),t.settings.gui.toppanel=!1,settings.save(),$body.addClass("toppanel-close"),$body.removeClass("toppanel")}),e(".toppanel-logo").click(function(e){e.preventDefault(),i(e),t.settings.gui.toppanel=!0,settings.save(),$body.removeClass("toppanel-close"),$body.addClass("toppanel")}),e.ajax({url:"/blog/all.json?"+(new Date).toString().split(" ").slice(0,4).join("-"),dataType:"json",cache:!0,success:function(n){var i=n.blog[0],o=t.root.replace(/^https/,"http");e(".toppanel-blog ul").html('<li><a href="'+o+"/"+i.slug+'" target="_blank" class="toppanel-link">'+i.title.replace(/TWDTW.*:\s/,"")+"</a></li>");var s=null,a=1;try{s=store.localStorage.getItem("lastpost")||null}catch(e){}null!==s&&(a=(s*=1)<i.timestamp?n.blog.reduce(function(e,t){return s<t.timestamp?e+1:e},0):0),a&&e(".blog a").attr("href",o+"/"+n.blog[a-1].slug).attr("data-count",a).on("click",function(){try{localStorage.lastpost=n.blog[a-1].timestamp}catch(e){}});var r=function(e){var t,n,i=e.length;for(;i;)n=Math.floor(Math.random()*i--),t=e[i],e[i]=e[n],e[n]=t;return e}(n.help);e(".toppanel-help ul").html('<li><a href="'+o+"/"+r[0].slug+'" target="_blank" class="toppanel-link">'+r[0].title+'</a></li><li><a href="'+o+"/"+r[1].slug+'" target="_blank" class="toppanel-link">'+r[1].title+"</a></li>")}}),e("#toppanel").find(".toppanel-link").mousedown(function(){n.welcomePanelLink(this.href)})}}),e("skylark-jsbin-client/chrome/help-search",["skylark-jquery","../jsbin"],function(e,t){"use strict";var n=e("#results"),i=e("#result-count"),o=[],s=e("#helpsearch"),a=-1;function r(e,t){var o,s,a;o=e,s="a an and on in it of if for the i is i'm i'd it's or to me be not was do so at are what bin bins".split(" "),a=new RegExp("("+"ing ly lies s".split(" ").join("|")+")$"),e=(o||"").replace(/(<([^>]+)>)/gi,"").replace(/\W/g," ").replace(/["'\.,]/g,"").toLowerCase().split(" ").filter(function(e){return-1===s.indexOf(e.trim())}).filter(function(e,t,n){return n.lastIndexOf(e)===t}).filter(function(e){return e.length>2}).map(function(e){return e.trim().replace(a,"")}).sort();var r=t.map(function(t){var n=e.filter(function(e){return-1!==t.words.indexOf(e)}).length;return{type:t.type,title:t.title,slug:t.slug,category:t.category,matches:n}}).filter(function(e){return e.matches>0}).sort(function(e,t){return t.matches-e.matches});n.html(r.map(function(e){return'<a target="_blank" class="button" href="/'+e.slug+'">'+e.title+("blog"===e.type?" (blog)":"")+"</a>"}).join("\n")),n.show();var c="";1!==r.length&&(c="s"),i.html(r.length+" result"+c)}s.on("input",throttle(function(){0===o.length?e.ajax({url:"/help/search.json?"+(new Date).toString().split(" ").slice(0,4).join("-"),dataType:"json",cache:!0,success:function(e){o=e,r(this.value,o)}.bind(this)}):r(this.value,o),a=-1},200)),n.on("mousemove",function(){-1!==a&&(n.children().remove("highlight"),a=-1)}),s.on("keydown",function(e){var t=e.which;if(38===t||40===t){e.preventDefault();var i=1;38===t&&(i=-1),a+=i;var o=n.children(),s=o.length;o.removeClass("hover"),a<0?a=s-1:a>s-1&&(a=0),o.eq(a).addClass("hover")}else if(13===t){var r=n.find(".hover")[0];r&&window.open(r.href)}})}),e("skylark-jsbin-client/chrome/app",["skylark-jquery","../jsbin","./gist","./analytics"],function(e,t,n,i){if(/gist\/.*/.test(window.location.pathname)&&(window.editors=editors,loadGist=function(){window.gist=new n(window.location.pathname.replace(/.*\/([^/]+)$/,"$1"))},editors.ready?loadGist():$document.on("jsbinReady",loadGist)),t.mobile||(document.body.onscroll=window.onscroll=function(){return 0!==document.body.scrollTop&&window.scrollTo(0,0),!1}),window.CodeMirror=CodeMirror,CodeMirror.keyMap&&CodeMirror.keyMap.default){var o="mac"===e.browser.platform?"Cmd":"Ctrl";delete CodeMirror.keyMap.default[o+"-L"],delete CodeMirror.keyMap.default[o+"-T"],delete CodeMirror.keyMap.default[o+"-W"],delete CodeMirror.keyMap.default[o+"-J"],delete CodeMirror.keyMap.default[o+"-R"]}t.embed&&i.embed()}),e("skylark-jsbin-client/main",["skylark-jsbin-coder","./jsbin","./chrome/font","./chrome/splitter","./chrome/analytics","./chrome/settings","./render/saved-history-preview","./chrome/esc","./chrome/share","./chrome/issue","./chrome/download","./chrome/login","./chrome/tips","./chrome/keys","./chrome/save","./chrome/navigation","./chrome/file-drop","./chrome/gist","./chrome/spinner","./chrome/infocard","./chrome/last-bin","./chrome/archive","./chrome/transfer","./chrome/welcome-panel","./chrome/help-search","./chrome/app"],function(e,t){return t}),e("skylark-jsbin-client",["skylark-jsbin-client/main"],function(e){return e})}(n),!o){var r=require("skylark-langx-ns");s?module.exports=r:t.skylarkjs=r}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-jsbin-client.js.map
