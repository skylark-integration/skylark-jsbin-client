/**
 * skylark-jsbin-client - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-client/
 * @license MIT
 */
!function(e,t){var n=t.define,require=t.require,o="function"==typeof n&&n.amd,s=!o&&"undefined"!=typeof exports;if(!o&&!n){var a={};n=t.define=function(e,t,n){"function"==typeof n?(a[e]={factory:n,deps:t.map(function(t){return function(e,t){if("."!==e[0])return e;var n=t.split("/"),i=e.split("/");n.pop();for(var o=0;o<i.length;o++)"."!=i[o]&&(".."==i[o]?n.pop():n.push(i[o]));return n.join("/")}(t,e)}),resolved:!1,exports:null},require(e)):a[e]={factory:null,resolved:!0,exports:n}},require=t.require=function(e){if(!a.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=a[e];if(!module.resolved){var n=[];module.deps.forEach(function(e){n.push(require(e))}),module.exports=module.factory.apply(t,n)||null,module.resolved=!0}return module.exports}}if(!n)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-jsbin-client/jsbin",["skylark-jsbin-base"],function(e){return e}),e("skylark-jsbin-client/chrome/font",["skylark-jquery","../jsbin"],function(e,t){var n,i=function(e){var n=e.getElementsByTagName("head")[0],i="#output li, #exec, .fakeInput, .fakeInput:before, #exec:before, #bin .editbox .CodeMirror, .mobile .editbox textarea",o=t.settings.font||14;function s(t){var o=i+"{ font-size: "+t+"px; }",s=e.createElement("style");s.type="text/css",s.styleSheet?s.styleSheet.cssText=o:s.appendChild(e.createTextNode(o)),n.appendChild(s)}if(Object.defineProperty&&t.settings)try{Object.defineProperty(t.settings,"font",{configurable:!0,enumerable:!0,get:function(){return o},set:function(e){s(o=1*e)}})}catch(e){}return s(o),s}(document);function o(e){var t=document.createElement("style");t.innerHTML=e,document.head.appendChild(t)}try{(n=window.localStorage.getItem("fonts"))&&("a3a02e450f1f79f4c3482279d113b07e"===(n=JSON.parse(n)).md5?o(n.value):(window.localStorage.removeItem("fonts"),n=null))}catch(e){return}return n||window.addEventListener("load",function(){var e=new XMLHttpRequest,n=t.static+"/css/fonts.a3a02e450f1f79f4c3482279d113b07e.woff.json?"+t.version;e.open("GET",n,!0),e.onload=function(){if(200==this.status)try{o(JSON.parse(this.response).value),window.localStorage.setItem("fonts",this.response)}catch(e){}},e.send()}),t.font=i}),e("skylark-jsbin-client/chrome/analytics",["skylark-langx","skylark-jquery","skylark-jsbin-chrome/analytics","../jsbin"],function(e,t,n,i){return e.mixin(n,{universalEditor:function(e){n.track("menu","universalEditor",e)},library:function(e,t){n.track("menu",e,"library",t)},infocard:function(e,t){n.track("infocard",e,t)},embed:function(){try{n.track("state","embed",window.top.location)}catch(e){n.track("state","embed")}},milestone:function(){n.track("bin","save",window.location.pathname)},clone:function(){n.track("bin","clone",window.location.pathname)},delete:function(){n.track("bin","delete",window.location.pathname)},lock:function(){n.track("bin","lock",window.location.pathname)},openShare:function(){n.track("menu","open","share")},saveTemplate:function(){n.track("menu","select","save-template")},createNew:function(e){n.track(e||"menu","select","new")},open:function(e){n.track(e||"menu","select","open")},openFromAvatar:function(){n.track("menu","select","open via avatar")},share:function(e,t){n.track("share",e,t)},download:function(e){n.track(e||"menu","select","download")},showPanel:function(e){n.track("panel","show",e)},hidePanel:function(e){n.track("panel","hide",e)},logout:function(){n.track("menu","select","logout")},register:function(e){void 0===e?n.track("menu","open","login"):n.track("user","register",ok?"success":"fail")},login:function(e){void 0===e?n.track("menu","open","login"):n.track("user","login",e?"success":"fail")},enableLiveJS:function(e){n.track("button","auto-run js",e?"on":"off")},archiveView:function(e){n.track("button","view archive",e?"on":"off")},archive:function(e){n.track("button","archive",e)},unarchive:function(e){n.track("button","unarchive",e)},loadGist:function(e){n.track("state","load gist",e)},layout:function(e){var t=[],i="";for(i in e)t.push(i.id);n.track("layout","update",t.sort().join(",")||"none")},run:function(e){n.track(e||"button","run with js")},publishVanity:function(){n.track("bin","publish-vanity")},runconsole:function(e){n.track(e||"button","run console")},welcomePanelState:function(e){var t="close";e&&(t="open"),n.track("state","welcome-panel",t)},welcomePanelLink:function(e){n.track("welcome-panel-link",e)}}),t('a[data-pro="true"]').on("click",function(){n.track("try-pro",t(this).text())}),n}),e("skylark-jsbin-client/chrome/settings",["skylark-jquery","../jsbin"],function(e,t){var n={save:function(n){localStorage.setItem("settings",JSON.stringify(t.settings)),n||(n=function(){}),e.ajax({url:"/account/editor",type:"POST",dataType:"json",data:{settings:localStorage.settings,_csrf:t.state.token},success:function(){console&&console.log&&console.log("settings saved"),n(!0)},error:function(e,t){n(!1)}})}};return t.chrome.settings=n}),e("skylark-jsbin-client/render/saved-history-preview",["skylark-jquery","skylark-jsbin-coder/editors/panels","../jsbin"],function(e,t,n){"use strict";if(n.user&&n.user.name&&!n.embed){var i,o=e("body"),s=!1,a=5;n.$document.on("history:open",function(){i&&0===t.getVisible().length&&i.appendTo("main")}).on("history:close",function(){null===i&&(i=e("#history").detach())});var r=function(){s||(e("html").hasClass("public-listing")?d():e.ajax({dataType:"html",url:n.root+"/list",error:function(){--a>0?(e("#history").remove(),setTimeout(r,500)):console.error("Giving up to load history")},success:function(t){e("#history").remove();var i=e(t);n.mobile&&i.find("tbody:gt(50)").remove(),o.append(i),d(),s=!0}}))},c=function(e,t){t.attr("src",e+"/quiet"),t.removeAttr("hidden")},l=function(e,t){t.html('<a href="'+e+'">'+e+"</a>")},u=function(t,n){var i=t.parent();t.detach().each(function(){var t=e(this),i=n?".archived":":not(.archived)",o=e("tr"+i,t).filter(":not(.spacer)");o.length>0?(o.filter(".first").removeClass("first"),t.removeClass("hidden"),o.first().addClass("first")):t.addClass("hidden")}).appendTo(i)},d=function(){if(!(i=e("#history").detach()).length)return i;var o=e("iframe",i),s=e("#viewing",i),a=i,r=e("tbody",i),d=e("tr",i),p=e(".toggle_archive",i);a.delegate(".archive, .unarchive","click",function(){var t=e(this),o=t.parents("tr");return o.toggleClass("archived"),analytics[-1===this.pathname.indexOf("unarchive")?"archive":"unarchive"](n.root+o.data("url")),u(r,i.hasClass("archive_mode")),e.ajax({type:"POST",url:t.attr("href"),error:function(){alert("Something went wrong, please try again"),o.toggleClass("archived"),u(r,i.hasClass("archive_mode"))},success:function(){}}),!1}),p.change(function(){i.toggleClass("archive_mode");var e=i.hasClass("archive_mode");analytics.archiveView(e),u(r,e)});var h=null;return a.delegate("a","click",function(i){if(!i.shiftKey&&!i.metaKey){var a=e(this);if(!a.closest(".action").length)if(i.preventDefault(),i.stopImmediatePropagation(),"history"!==a.data("toggle")){var r=a.closest("tr"),u=r.data(),p=n.root+u.url;h===this?window.location=u.editUrl:(d.removeClass("selected"),r.addClass("selected"),c(p,o),l(p,s),h=this)}else t.allEditors(function(e){e.editor.getCode().trim().length&&e.show()})}}),a.delegate("tr:not(.spacer)","click",function(t){t.shiftKey||t.metaKey||e(this).find(".url a:first").click()}),e("a[pubdate]",i).attr("pubdate",function(e,t){return t.replace("Z","+0000")}).prettyDate(),setTimeout(function(){u(r,!1)},0),n.$document.trigger("history:open"),i};return e(document).on("jsbinReady",function(){if(!n.embed){var t=e("#panels a"),i=e(".homebtn"),s=o.hasClass("panelsVisible");i.on("click",r),t.on("mousedown",function(){1===t.filter(".active").length&&e(this).hasClass("active")&&r()}),n.$document.on("history:load",r),s||r()}}),{loadList:r,updatePreview:c,updateViewing:l,updateLayout:u,hookUserHistory:d}}}),e("skylark-jsbin-client/chrome/esc",["skylark-jquery","skylark-jsbin-chrome/hideOpen","../jsbin"],function(e,t,n){n.$document.keydown(function(e){27==e.which&&t()}),n.$document.delegate(".modal","click",function(n){e(n.target).is(".modal")&&t()})}),e("skylark-jsbin-client/chrome/share",["skylark-jquery","skylark-jsbin-processors","skylark-jsbin-coder/editors/panels","../jsbin"],function(e,t,n,i){"use strict";if(0!==e("#sharemenu .share-split").length){var o={live:"output",javascript:"js"},s=e('#sharepanels input[type="checkbox"]'),a=i.state.revision;i.$document.on("saved",function(){a=i.state.revision}),i.$document.on("snapshot",function(){i.state.changed=!1,window.history.replaceState&&window.history.replaceState(null,"",i.getURL({withRevision:!0})+"/edit?"+n.getQuery())});var r=e("#sharemenu").bind("open",function(){s.prop("checked",!1),n.getVisible().forEach(function(e){s.filter('[value="'+(o[e.id]||e.id)+'"]').prop("checked",!0)}),i.state.latest?(i.state.checksum?(l.prop("checked",i.state.latest),u.prop("checked",!1),g.show()):(l.prop({checked:!1}),u.prop("checked",!0),g.hide()),v.show()):(l.prop({checked:!1,disabled:!0}),u.prop("checked",!0),v.hide()),w()});r.find(".lockrevision").on("change",function(){i.saveChecksum=!1,i.state.checksum=!1,i.$document.trigger("locked")});var c=e("#share-preview"),l=e('#sharebintype input[type=radio][value="realtime"]'),u=e('#sharebintype input[type=radio][value="snapshot"]'),d=r.find("a.link")[0],p=r.find('input[name="url"]')[0],h=r.find("textarea")[0],f=r.find("form")[0],m=r.find(".direct-links"),g=e("#andlive"),v=r.find(".codecasting");e("#sharebintype input[type=radio]").on("change",function(){"snapshot"===this.value?(i.state.checksum=!1,i.saveChecksum=!1,v.hide()):v.show()}),r.find("input").on("change",w),i.$document.on("saved",function(){l.prop("checked",!0),r.removeClass("hidden"),w()});var k=e("#share").closest(".menu"),y=e("#sharemenu a")[0],b=e("a.show-share").on("click",function(){k.hasClass("open")?closedropdown(y):opendropdown(y,!0),b.blur()})}function w(){var e=function(e){for(var t,n,i,o,s=e.length,a={},r=function(e,t,n){void 0===e[t]?e[t]=n:("string"==typeof e[t]&&(e[t]=[e[t]]),e[t].push(n))},c=0;c<s;c++)n=e[c],t=n.value,i=n.type,o=n.name,"radio"===i?n.checked&&r(a,o,t):"checkbox"===i?(void 0===a[o]&&(a[o]=[]),n.checked&&r(a,o,t)):r(a,o,t);return a}(f),o=i.getURL({root:i.shareRoot}),r=i.getURL();"snapshot"===e.state&&i.state.latest&&(o+="/"+a,r+="/"+a);var l=o,u=e.panel.join(",");u&&(u="?"+u),s.prop("disabled","output"===e.view),c.attr("class",e.view),"output"!==e.view&&c.find(".editor div").each(function(){this.hidden=-1===e.panel.indexOf(this.className)}),"editor"===e.view?l+="/edit":u="",m.empty();var g=[],v="",k="";if((v=n.named.html.getCode().trim())&&("html"!==(k=t[i.state.processors.html||"html"].extensions[0])?g.push('<a target="_blank" href="'+o+"."+k+'">'+k+"</a>"):0===v.toLowerCase().indexOf("<svg")&&g.push('<a target="_blank" href="'+o+'.svg">svg</a>')),n.named.css.getCode().trim()&&("css"!==(k=t[i.state.processors.css||"css"].extensions[0])&&g.push('<a target="_blank" href="'+o+'.css">css</a>'),g.push('<a target="_blank" href="'+o+"."+k+'">'+k+"</a>")),v=n.named.javascript.getCode().trim()){"js"!==(k=t[i.state.processors.javascript||"javascript"].extensions[0])&&g.push('<a target="_blank" href="'+o+'.js">js</a>');try{JSON.parse(v),g.push('<a target="_blank" href="'+o+'.json">json</a>')}catch(e){g.push('<a target="_blank" href="'+o+"."+k+'">'+k+"</a>")}}m.html(g.join("")),p.value=d.href=l+u,h.value=('<a class="jsbin-embed" href="'+r+"/embed"+u+'">'+i.documentTitle+' on jsbin.com</a><script src="'+i.static+"/js/embed.min.js?"+i.version+'"><\/script>').replace(/<>"&/g,function(e){return{"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;"}[e]})}}),e("skylark-jsbin-client/chrome/issue",["skylark-jquery","../jsbin"],function(e,t){"use strict";function n(){var e=["Please provide any additional information, record a screencast ","with http://quickcast.io or http://screenr.com and attach a screenshot ","if possible.\n\n**JS Bin info**\n\n* [%url%/edit](%url%/edit)\n* ",window.navigator.userAgent+"\n",t.user&&t.user.name?"* "+t.user.name:"","\n"].join("");return"http://github.com/jsbin/jsbin/issues/new?body="+encodeURIComponent(e.replace(/%url%/g,t.getURL({withRevision:!0})))}var i=e("#newissue");return e("#help").parent().on("open",function(){i.attr("href",n())}),n}),e("skylark-jsbin-client/chrome/download",["skylark-jquery","../jsbin","./analytics"],function(e,t,n){e("#download").click(function(e){e.preventDefault(),window.location=t.getURL({withRevision:!0})+"/download",n.download()})}),e("skylark-jsbin-client/chrome/login",["skylark-jquery","../jsbin"],function(e,t){e("form.login").submit(function(t){"use strict";t.preventDefault();var n=e(this),i=n.find("input[name=username]").val(),o=n.find("input[name=password]").val(),s=n.find("input[name=email]").val(),a=n.find(".loginFeedback");a.show().text("Checking..."),e.ajax({url:n.attr("action"),data:{username:i,key:o,email:s},type:"POST",dataType:"json",complete:function(t){var n=e.parseJSON(t.responseText)||{};200===t.status?(n.avatar&&e("a.avatar").find("img").remove().end().prepend('<img src="'+n.avatar+'">'),n.message?a.text(n.message):window.location=window.location.pathname+window.location.search):(analytics.login(!1),a.text(n.message||'"'+i+'" has already been taken. Please either double check the password, or choose another username.'))}})})}),e("skylark-jsbin-client/chrome/tips",["skylark-jquery","../jsbin"],function(e,t){var n,i=e(document.documentElement),o=e("#tip"),s=e("p",o),a=function(t){i.removeClass("showtip"),o.removeClass(),s.html(""),e(window).resize(),t&&setTimeout(t,0)},r=function(e){clearTimeout(n),s.html(e.content),o.removeClass().addClass(e.type||"info"),i.addClass("showtip"),e.autohide&&(n=setTimeout(function(){a()},parseInt(e.autohide,10)||5e3))};t.$document.on("tip",function(e,t){var n=t;if("string"==typeof t&&((n={}).content=t,n.type="info"),s.html()===n.content&&o.hasClass(n.type))return r(t);a(function(){r(n)})}),e("#tip").on("click","a.dismiss",function(){return a(),!1}),t.$document.keydown(function(e){27==e.which&&a()})}),e("skylark-jsbin-client/chrome/keys",["skylark-jquery","../jsbin"],function(e,t){"use strict";if(!t.user||!t.user.name){var n={},i=function(e){var i=n[e||t.getURL({withRevision:!0,withoutRoot:!0})]||{};return i.c};try{"localStorage"in window&&window.localStorage}catch(e){return i}return t.$document.on("saved",function(){n[t.getURL({withRevision:!1,withoutRoot:!0})]={s:t.state.revsion,c:t.state.checksum,d:(new Date).getTime()},localStorage.keys=JSON.stringify(n)}),window.addEventListener("storage",function(e){"keys"===e.key&&o()}),o(),t.keys=i}function o(){n=JSON.parse(localStorage.keys||"{}")}}),e("skylark-jsbin-client/chrome/save",["skylark-jquery","skylark-jsbin-base/storage","skylark-jsbin-coder/editors/panels","../jsbin","./analytics"],function(e,t,n,i,o){var s={todo:{html:!1,css:!1,javascript:!1},_inprogress:!1,inprogress:function(e){if(void 0===e)return s._inprogress;if(s._inprogress=e,!1===e){var t=["html","css","javascript"],n=function(){var e=t.pop();e&&s.todo[e]?(s._inprogress=!0,v(e,n),s.todo[e]=!1):e&&n()};n()}}};function a(e){var t=n.named.html.getCode(),i="";return-1===t.indexOf("<"+e)?i:"title"!==e&&"meta"!==e?(console.error("getTagContent for "+e+" is not supported"),i):(t.replace(a.re[e],function(t,n,o){i="title"===e?n:o}),i)}a.re={meta:/(<meta name="description" content=")([^"]*)/im,title:/<title>(.*)<\/title>/im},e("a.save").click(function(e){e.preventDefault(),o.milestone();var t=!0;return!0===i.saveDisabled&&(t=!1),(i.state.changed||i.mobile||!i.owner())&&b("save",t),!1});var r=e("#share .link"),c=e("#sharemenu #sharepanels input"),l=e("#sharemenu .share-split").length;function u(){"use strict";if(!l){var e={live:"output",javascript:"js",css:"css",html:"html",console:"console"},t=c.filter(":checked").map(function(){return e[this.getAttribute("data-panel")]}).get().join(",");r.each(function(){var e=this.getAttribute("data-path"),o=i.getURL({withRevision:!0})+e+(t&&"livepreview"!==this.id?"?"+t:""),s=this.nodeName,a=n.getHighlightLines();a&&(a="#"+a),"A"===s?this.href=o:"INPUT"===s?(this.value=o,"/edit"===e&&(this.value+=a)):"TEXTAREA"===s&&(this.value=('<a class="jsbin-embed" href="'+o+a+'">'+i.documentTitle+'</a><script src="'+i.static+'/js/embed.js"><\/script>').replace(/<>"&/g,function(e){return{"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;"}[e]}))})}}e("#sharemenu").bind("open",u),e("#sharebintype input[type=radio]").on("click",function(){"snapshot"===this.value&&(i.state.checksum=!1,h=!1),u()});var d=null;function p(e,t){if(!t||"html"===t.panelId){var o=n.named.html.getCode();if(d!==o){d=o;var s=a("meta");s!==i.state.description&&(i.state.description=s,i.state.updateSettings({description:s}));var r=a("title");r!==i.state.title&&(i.state.title=r,i.state.updateSettings({title:r}),i.documentTitle=r,i.documentTitle?document.title=i.documentTitle+" - "+i.name:document.title=i.name)}}}i.$document.on("saveComplete",p),i.$document.on("saved",function(){i.state.changed=!1,u(),e('#sharebintype input[type=radio][value="realtime"]').prop("checked",!0),r.closest(".menu").removeClass("hidden"),e("#jsbinurl").attr("href",i.getURL()).removeClass("hidden"),e("#clone").removeClass("hidden"),p()});var h=i.state.checksum||t.sessionStorage.getItem("checksum")||!1;function f(t,n){413===t.status?(e("#tip p").html("Sorry this bin is too large for us to save"),e(document.documentElement).addClass("showtip")):403===t.status?i.$document.trigger("tip",{type:"error",content:"I think there's something wrong with your session and I'm unable to save. <a href=\""+window.location+'"><strong>Refresh to fix this</strong></a>, you <strong>will not</strong> lose your code.'}):n&&(n&&m[n].text("Saving...").animate({opacity:1},100),window._console.error({message:"Warning: Something went wrong while saving. Your most recent work is not saved."}))}if(i.state.checksum=h,h?e("#share div.disabled").removeClass("disabled").unbind("click mousedown mouseup"):e("#share div.disabled").one("click",function(t){t.preventDefault(),e("a.save").click()}),i.$document.one("saved",function(){e("#share div.disabled").removeClass("disabled").unbind("click mousedown mouseup")}),i.saveDisabled)i.$document.one("jsbinReady",function(){"use strict";var e=!1;i.embed||i.sandbox||i.$document.on("codeChange.live",function(t,n){if(!n.onload&&!e&&"setValue"!==n.origin){e=!0;var o=-1!==navigator.userAgent.indexOf(" Mac "),s=o?"⌘":"ctrl",a=o?"⇧":"shift",r=o?"":"+";i.$document.trigger("tip",{type:"notification",content:'You\'re currently viewing someone else\'s live stream, but you can <strong><a class="clone" href="'+i.root+'/clone">clone your own copy</a></strong> ('+s+r+a+r+"S) at any time to save your edits"})}})});else{e(".code.panel .label .name").append('<span class="saved">Saved</span>');var m={html:e(".panel.html .name span.saved"),javascript:e(".panel.javascript .name span.saved"),css:e(".panel.css .name span.saved")};i.$document.bind("jsbinReady",function(){i.state.changed=!1,n.allEditors(function(e){e.on("processor",function(){i.root!==i.getURL()&&i.$document.trigger("codeChange",[{panelId:e.id}])})}),i.$document.bind("codeChange",function(e,t){i.state.changed=!0,m[t.panelId]&&m[t.panelId].css({opacity:0}).stop(!0,!0)}),i.$document.bind("saveComplete",i.throttle(function(e,t){m[t.panelId].text("Saved").stop(!0,!0).animate({opacity:1},100).delay(1200).animate({opacity:0},500)},500)),i.$document.bind("codeChange",i.throttle(function(e,t){if(t.panelId&&!i.state.deleted){var o=t.panelId;n.savecontent(),s.inprogress()?s.todo[o]=!0:(s.inprogress(!0),h&&i.state.code?v(o):b("save",!0))}},3e4))})}function g(e,t){t.compressed=e,e.split(",").forEach(function(e){t[e]=LZString.compressToUTF16(t[e])})}function v(t,o){var a={};i.state.processors&&(a.processors=i.state.processors);var r={code:i.state.code,revision:i.state.revision,method:"update",panel:t,content:n.named[t].getCode(),checksum:i.saveChecksum,settings:JSON.stringify(a)};i.settings.useCompression&&"http:"===location.protocol&&g("content",r),i.state.processors[t]&&i.state.processors[t]!==t&&i.state.cache[t]&&(r.processed=i.state.cache[t].result),e.ajax({url:i.getURL({withRevision:!0})+"/save",data:r,type:"post",dataType:"json",headers:{Accept:"application/json"},success:function(e){i.$document.trigger("saveComplete",{panelId:t}),e.error?b("save",!0,function(){}):i.state.latest=!0},error:function(e){f(e,t)},complete:function(){s.inprogress(!1),o&&o()}})}function k(e){e.preventDefault(),n.save(),o.clone();var t=y("save,new");return t.submit(),!1}function y(t){var o=e("form#saveform").empty().append('<input type="hidden" name="javascript" />').append('<input type="hidden" name="html" />').append('<input type="hidden" name="css" />').append('<input type="hidden" name="method" />').append('<input type="hidden" name="_csrf" value="'+i.state.token+'" />').append('<input type="hidden" name="settings" />').append('<input type="hidden" name="checksum" />'),s={};return i.state.processors&&(s.processors=i.state.processors),"welcome"===i.state.code&&o.attr("action","/save"),o.find("input[name=settings]").val(JSON.stringify(s)),o.find("input[name=javascript]").val(n.named.javascript.getCode()),o.find("input[name=css]").val(n.named.css.getCode()),o.find("input[name=html]").val(n.named.html.getCode()),o.find("input[name=method]").val(t),o.find("input[name=checksum]").val(i.state.checksum),o}function b(o,a,r){var c=y(o);n.save(),n.saveOnExit=!0;var u=c.serializeArray().reduce(function(e,t){return e[t.name]=t.value,e},{});i.settings.useCompression&&g("html,css,javascript",u),a?e.ajax({url:i.getURL({withRevision:!0})+"/save",data:u,dataType:"json",type:"post",headers:{Accept:"application/json"},success:function(e){if(r&&r(e),t.sessionStorage.setItem("checksum",e.checksum),h=e.checksum,i.state.checksum=h,i.state.code=e.code,i.state.revision=e.revision,i.state.latest=!0,i.state.metadata={name:i.user.name},c.attr("action",i.getURL({withRevision:!0})+"/save"),window.history&&window.history.pushState){var o=n.getHighlightLines();o&&(o="#"+o);var s=n.getQuery();s&&(s="?"+s),window.history.pushState(null,"",i.getURL({withRevision:!l})+"/edit"+s+o),t.sessionStorage.setItem("url",i.getURL({withRevision:!l}))}else window.location.hash=e.edit;i.$document.trigger("saved")},error:function(e){f(e,null)},complete:function(){s.inprogress(!1)}}):c.submit()}e("a.clone").click(k),e("#tip").delegate("a.clone","click",k)}),e("skylark-jsbin-client/chrome/archive",["skylark-jquery","../jsbin","./analytics"],function(e,t,n){function i(){t.state.metadata&&t.state.metadata.archive?(e("a.archivebin").hide(),e("a.unarchivebin").show()):(e("a.archivebin").show(),e("a.unarchivebin").hide())}return i(),t.archive=function(o){"use strict";var s=!1===o?"unarchive":"archive",a=!1===o?"restore from archive":"archiving";n[s](t.getURL({withRevision:!0})),t.user.name?t.owner()?e.ajax({type:"POST",url:t.getURL({withRevision:!0})+"/"+s,error:function(){t.$document.trigger("tip",{type:"error",content:"The "+a+" failed. If this continues, please can you file an issue?"})},success:function(){t.state.metadata.archive=!1!==o,i(),t.$document.trigger("tip",{type:"notication",autohide:5e3,content:"This bin is now "+(!1===o?"restored from the archive.":"archived.")})}}):t.$document.trigger("tip",{type:"notication",content:"The "+a+" failed. You can only archive bins that you own."}):t.$document.trigger("tip",{type:"notication",content:"You must be logged in and the owner of the bin to archive."})}}),e("skylark-jsbin-client/chrome/navigation",["skylark-jquery","skylark-jsbin-base/storage","skylark-jsbin-chrome/hideOpen","skylark-jsbin-coder/editors/panels","../jsbin","./analytics","./archive","./settings"],function(e,t,n,o,s,a,r,c){e("a.startingpoint").click(function(e){return e.preventDefault(),localStorage?(a.saveTemplate(),localStorage.setItem("saved-javascript",o.named.javascript.getCode()),localStorage.setItem("saved-html",o.named.html.getCode()),localStorage.setItem("saved-css",o.named.css.getCode()),localStorage.setItem("saved-processors",JSON.stringify({javascript:o.named.javascript.processor.id,html:o.named.html.processor.id,css:o.named.css.processor.id})),s.$document.trigger("tip",{type:"notification",content:"Starting template updated and saved",autohide:3e3})):s.$document.trigger("tip",{type:"error",content:"Saving templates isn't supported in this browser I'm afraid. Sorry"}),!1});e("a.disabled").on("click mousedown mouseup",function(e){return e.stopImmediatePropagation(),!1}),e("#loginbtn").click(function(){a.login(),e(this).toggleClass("open")}),e("a.logout").click(function(n){for(n.preventDefault(),e(this.hash).submit(),i=0;i<t.sessionStorage.length;i++)key=t.sessionStorage.key(i),0===key.indexOf("jsbin.content.")&&t.sessionStorage.removeItem(key)}),e(".homebtn").click(function(t,i){return"avatar"===this.id?a.openFromAvatar():"profile"===this.id?(a.openFromAvatar(),e(this).closest(".open").removeClass("open")):a.open(i),n(),o.hideAll(),!1});var l=e("div.lockrevision").on("click",function(e){e.preventDefault(),s.saveChecksum=!1,s.$document.trigger("locked")}).on("mouseup",function(){return!1});if(s.$document.on("locked",function(){l.data("locked")||(a.lock(),l.removeClass("icon-unlocked").addClass("icon-lock"),l.html("<span>This bin is now locked from further changes</span>"),l.data("locked",!0))}),s.$document.on("saved",function(){l.removeClass("icon-lock").addClass("icon-unlocked").data("locked",!1),l.html("<span>Click to lock and prevent further changes</span>")}),!e("#sharemenu .share-split").length){var u=e('#sharepanels input[type="checkbox"]').on("change",function(){updateSavedState()});e("#sharemenu").bind("open",function(){u.attr("checked",!1),o.getVisible().forEach(function(e){u.filter('[data-panel="'+e.id+'"]').prop("checked",!0).change()})})}e("#jsbinurl").click(function(e){setTimeout(function(){o.named.live.hide()},0)}),e("#runwithalerts, li.run-with-js a").click(function(e,t){return a.run(t),o.named.console.visible?o.named.console.render(!0):o.renderLivePreview(!0),!1}),e("#runconsole").click(function(){return a.runconsole(),o.named.console.render(!0),!1}),e("#clearconsole").click(function(){return jsconsole.clear(),!1}),e("#showhelp").click(function(){return $body.toggleClass("keyboardHelp"),keyboardHelpVisible=$body.is(".keyboardHelp"),keyboardHelpVisible,!1}),e("a.toggle-side-nav").on(s.mobile?"touchstart":"click",function(){return $body.toggleClass("show-nav"),sideNavVisible=$body.is(".show-nav"),sideNavVisible||s.mobile||e("#skipToEditor").click(),sideNavVisible}),e("#showurls").click(function(){return $body.toggleClass("urlHelp"),urlHelpVisible=$body.is(".urlHelp"),urlHelpVisible,!1}),e(".code.panel > .label > span.name").dblclick(function(){o.allEditors(function(e){var t=!e.editor.getOption("lineNumbers");e.editor.setOption("lineNumbers",t),s.settings.editor.lineNumbers=t})}),e("a.createnew").click(function(e){var n,i;for(e.preventDefault(),a.createNew(),o.savecontent=function(){},n=0;n<t.sessionStorage.length;n++)0===(i=t.sessionStorage.key(n)).indexOf("jsbin.content.")&&t.sessionStorage.removeItem(i);t.sessionStorage.removeItem("checksum"),o.saveOnExit=!1,o.restore(),setTimeout(function(){0===o.getVisible().length&&(o.named.html.show(),o.named.live.show()),window.location=s.root},0)});var d=e("#control a.visibilityToggle#private"),p=e("#control a.visibilityToggle#public"),h=e("#control a.visibilityToggle").click(function(t){t.preventDefault();var n=e(this).data("vis");e.ajax({url:s.getURL({withRevision:!0})+"/"+n,type:"post",success:function(e){s.$document.trigger("tip",{type:"notification",content:"This bin is now "+n,autohide:6e3}),h.css("display","none"),"public"===n?d.css("display","block"):p.css("display","block")}})});e("form.login").closest(".menu").bind("close",function(){e(this).find(".loginFeedback").empty().hide(),e("#login").removeClass("forgot")}),e("#lostpass").click(function(t){return e("#login").addClass("forgot").find("input[name=email]").focus(),!1}),s.settings.includejs=void 0===s.settings.includejs||s.settings.includejs,!s.embed&&t.sessionStorage.getItem("runnerPending")&&(s.$document.trigger("tip",{content:'It looks like your last session may have crashed, so I\'ve disabled "Auto-run JS" for you',type:"error"}),t.sessionStorage.removeItem("runnerPending"),s.settings.includejs=!1),e("#enablejs").change(function(){s.settings.includejs=this.checked,a.enableLiveJS(s.settings.includejs),o.named.live.render()}).attr("checked",s.settings.includejs),!s.embed&&s.settings.hideheader&&s.$body.addClass("hideheader");var f=!1;e("form input, form textarea").focus(function(){this.select(),f=!0}).mouseup(function(){if(f)return f=!1,!1}),window.location.hash&&e('a[href$="'+window.location.hash+'"]').mousedown();var m=-1!==navigator.userAgent.indexOf(" Mac "),g={ctrl:"⌘",shift:"⇧",del:"⌫"};e("#control").find("a[data-shortcut]").each(function(){var t=e(this),n=t.data(),i=n.shortcut;m&&(i=i.replace(/ctrl/i,g.ctrl).replace(/shift/,g.shift).replace(/del/,g.del).replace(/\+/g,"").toUpperCase()),t.append('<span class="keyshortcut">'+i+"</span>")}),function(){var t={head:/<head(.*)\n/i,meta:/<meta name="description".*?>/i,metaContent:/content=".*?"/i},n='<meta name="description" content="[add your bin description]">\n';e("#addmeta").click(function(){var e=o.named.html,i=e.editor,s=e.getCode();e.visible||e.show(),t.meta.test(s)||(s=t.head.test(s)?s.replace(t.head,"<head$1\n"+n):n+s),e.setCode(s);var a=i.getSearchCursor(t.meta);a.findNext();var r=i.getSearchCursor(t.metaContent);r.findNext();var c={line:a.pos.from.line,ch:a.pos.from.ch+'<meta name="description" content="'.length},l={line:r.pos.to.line,ch:r.pos.to.ch-1};i.setCursor(c),i.setSelection(c,l),i.on("cursoractivity",function(){i.on("cursoractivity",null),u.clear()});var u=i.markText(c,l,{className:"highlight"});return i.focus(),!1}),e("a.publish-to-vanity").on("click",function(t){t.preventDefault(),a.publishVanity(),e.ajax({type:"post",url:this.href,data:{url:s.getURL({withRevision:!0})},success:function(){s.$document.trigger("tip",{type:"notification",content:'This bin is now published to your vanity URL: <a target="_blank" href="'+s.shareRoot+'">'+s.shareRoot+"</a>"})},error:function(e){s.$document.trigger("tip",{type:"error",content:'There was a problem publishing to your vanity URL. Can you try again or file a <a target="_blank" href="'+githubIssue()+'">new issue</a>?'})}})}),s.$document.on("click","a.deleteallbins",function(){s.user&&s.state.metadata.name===s.user.name?confirm("Delete all snapshots of this bin including this one?")&&(a.deleteAll(),e.ajax({type:"post",url:s.getURL()+"/delete-all",success:function(){s.state.deleted=!0,s.$document.trigger("tip",{type:"error",content:"This bin and history is now deleted. You can continue to edit, but once you leave the bin can't be retrieved"})},error:function(e){403===e.status&&s.$document.trigger("tip",{content:"You don't own this bin, so you can't delete it.",autohide:5e3})}})):s.$document.trigger("tip",{type:"error",content:'You must be logged in <em><strong>the bin owner</strong></em> to delete all snapshots. <a target="_blank" href="/help/delete-a-bin">Need help?</a>'})}),e("a.deletebin").on("click",function(t){t.preventDefault(),confirm("Delete this bin?")&&(a.delete(),e.ajax({type:"post",url:s.getURL({withRevision:!0})+"/delete",data:{checksum:s.state.checksum},success:function(){s.state.deleted=!0,s.$document.trigger("tip",{type:"error",content:"This bin is now deleted. You can continue to edit, but once you leave the bin can't be retrieved"})},error:function(e){403===e.status&&s.$document.trigger("tip",{content:"You don't own this bin, so you can't delete it.",autohide:5e3})}}))}),e("a.archivebin").on("click",function(e){e.preventDefault(),r()}),e("a.unarchivebin").on("click",function(e){e.preventDefault(),r(!1)});var i=e("#enableUniversalEditor").on("change",function(e){e.preventDefault(),s.settings.editor.simple=this.checked,a.universalEditor(s.settings.editor.simple),c.save(function(){window.location.reload()})});s.settings.editor.simple&&i.prop("checked",!0),e("#skipToEditor").on("click keypress",function(){var t=(o.getVisible()||["html"]).shift();return s.settings.editor.simple||s.mobile?e("#"+t.id).focus():t?t.editor.focus():o.named.html.editor.focus(),!1})}()}),e("skylark-jsbin-client/chrome/file-drop",["skylark-jquery","../jsbin"],function(e,t){window.File&&window.FileList&&window.FileReader&&function(n){var i=null,o=null,s=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return e()+e()}}();function a(n){var s=document.createElement("div");s.className="assetLoading",s.innerHTML="0% uploading...";var a=0,l=null,u=i||o.getCursor();if(t.lameEditor)r(o,"Uploading ...",!0);else{var d=i?i.line:o.getCursor().line;l=o.addLineWidget(d,s,{coverGutter:!1,nohscroll:!0})}new S3Upload({s3_sign_put_url:"/account/assets/sign",s3_object_name:n.name.replace(/\s+/g,"-"),files:[n],onProgress:function(e,n){t.lameEditor||requestAnimationFrame(function(){!function e(t,n){t-a<10?a=t:(a+=10,requestAnimationFrame(function(){e(t,n)}));s&&a>0&&(s.innerHTML=a>97?"97% uploaded...":a+"% uploaded...")}(e,n)})},onError:function(e,t){a=-1,console.error("Failed to upload: "+t),s.innerHTML=t||"Failed to complete",s.style.color="red",o=null,i=null,l&&setTimeout(function(){l.clear()},4e3)},onFinishS3Put:function(s){t.lameEditor?(r(o,c(n.type,o,s)),e(document).trigger("codeChange",{panelId:o.id})):(l.clear(),o.replaceRange(c(n.type,o,s),u)),o=null,i=null}})}function r(e,t,n){var i=e.selectionStart,o=e.selectionEnd,s=e,a=s.value;s.value=a.substring(0,i)+t+a.substring(o),e.selectionStart=e.selectionEnd=i+1,n?(e.selectionStart-=1,e.selectionEnd=e.selectionEnd+t.length):e.selectionStart=e.selectionEnd=i+t.length}function c(e,n,i){var o=t.state.processors[n.id];return"html"===n.id?0===e.indexOf("image/")?"markdown"===o?"!["+i+"]("+i+")":"jade"===o?'img(src="'+i+'")':'<img src="'+i+'">':i:"css"===n.id&&0===e.indexOf("image/")?"url("+i+")":i}var l=!1;function u(e){return new Promise(function(t,n){"string"===e.kind?e.getAsString(function(e){t(e)}):t(e.getAsFile())})}n.ondragover=function(){return l=!0,!1},n.ondragend=function(){return l=!1,!1},e("#bin textarea").on("paste",function(t){o=e(this).closest(".CodeMirror").length?e(this).closest(".CodeMirror")[0].CodeMirror:this;var n=t.originalEvent,i=n.clipboardData.items;if(i&&0!==n.clipboardData.types[0].indexOf("text/")){for(var r=[],c=0;c<i.length;c++)r.push(u(i[c]));Promise.all(r).then(function(e){e.sort(function(e,t){return"string"==typeof e?1:-1});var t=e[0];t.name=e[1]||s()+"."+t.type.split("/")[1],a(t)}).catch(function(e){console.log(e.stack)}),t.preventDefault()}}),e(".CodeMirror").on("mousemove",function(e){l&&(o=this.CodeMirror,i=this.CodeMirror.coordsChar({top:event.y,left:event.x}),this.CodeMirror.setCursor(i))});var d=["javascript","coffeescript","coffee","js"],p=["css","less","sass","scss"],h=["html","markdown","plain"];n.ondrop=function(n){l=!1,n.preventDefault(),o=e(n.target).closest(".CodeMirror").length?e(n.target).closest(".CodeMirror")[0].CodeMirror:n.target;var i=n.dataTransfer.files[0],s=new FileReader;if(0===i.type.indexOf("text/"))return s.onload=function(e){var n=i.type?i.type.toLowerCase().replace(/^(text|application)\//,""):i.name.toLowerCase().replace(/.*\./g,""),o=null,s=editors[o],r=(e.target.result,null);if(-1!==d.indexOf(n)?o="javascript":-1!==p.indexOf(n)?o="css":-1!==h.indexOf(n)&&(o="html"),null===o)return a(i);s=editors[o],r=s.editor.scroller,s.setCode(e.target.result),s.show();try{var c=new Worker(t.static+"/js/editors/sync-worker.js");c.postMessage(i),s.$el.find("> .label").append("<small> (live: edit & save in your fav editor)</small>"),c.onmessage=function(e){var t=r.scrollTop;s.setCode(e.data.body),r.scrollTop=t,e.data.body}}catch(e){}},s.readAsText(i),!1;a(i)}}(document.body)}),e("skylark-jsbin-client/chrome/gist",["skylark-jquery","skylark-jsbin-bintofile","skylark-jsbin-processors","skylark-jsbin-coder/editors/panels","../jsbin"],function(e,t,n,i,o){"use strict";var s=!!("withCredentials"in new XMLHttpRequest||"undefined"!=typeof XDomainRequest);if(!s)return e(function(){e("#export-as-gist").remove()});var a=function(t){var n=this,i="";return n.code={},o.user&&o.user.github_token&&(i="?access_token="+o.user.github_token),e.get("https://api.github.com/gists/"+t+i,function(t){t&&(e.each(t.files,function(e,t){var i=e.split(".").slice(-1).join("");n.code[i]=t.content}),n.setCode())}),this};return a.prototype.setCode=function(){e.each(this.code,function(e,t){var s=o.processors.findByExtension(e),a=s.target||s.id,r=i.named[a];r&&(n.set(a,s.id),o.saveDisabled=!0,r.setCode(t),o.saveDisabled=!1)})},e("a.export-as-gist").click(function(){var s={public:!0,files:{}},a=[i.named.html.render(),i.named.javascript.render(),i.named.css.render()];return Promise.all(a).then(function(a){var r={html:a[0],javascript:a[1],css:a[2]};Object.keys(r).forEach(function(e){var t=n[e].extensions?n[e].extensions[0]:e,i=["jsbin",o.state.code||"untitled",t].join(".");r[e].length&&(s.files[i]={content:r[e]})}),s.files.javascript||s.files.css||delete s.files[["jsbin",o.state.code||"untitled","html"].join(".")],o.state.processors&&(i.source=o.state.processors,Object.keys(i.source).forEach(function(e){i.source[e]=i.named[e].getCode()}));var c=t(r);s.files["index.html"]={content:c};var l=[];o.state.title&&l.push(o.state.title),o.state.description&&l.push(o.state.description),l.push("// source "+o.getURL()),s.description=l.join("\n\n");var u="";o.user&&o.user.github_token&&(u="?access_token="+o.user.github_token),e.ajax({type:"POST",url:"https://api.github.com/gists"+u,data:JSON.stringify(s),dataType:"json",crossDomain:!0,success:function(e){o.$document.trigger("tip",{type:"notification",content:'Gist created! <a href="'+e.html_url+'" target="_blank">Open in new tab.</a>'})},error:function(e,t,n){o.$document.trigger("tip",{type:"error",content:"There was a problem creating the gist: "+n}),console.group("gist"),console.log(s),console.groupEnd("gist")}})},function(e){console.error(e.stack)}),!1}),a}),e("skylark-jsbin-chrome/spinner",["skylark-jquery","./chrome"],function(e,t){return t.spinner=function(e){"use strict";var t=e||document.createElement("canvas");if(!t.getContext)return!1;var n=t.getContext("2d"),i=null;t.height=t.width=11;var o=Math.PI/180,s=t.width,a=t.height,r=0,c=4,l=4,u=1/7;n.strokeStyle="rgba(0,0,0,.5)",n.lineWidth=1.5;var d=!0;return{element:t,start:function e(){i=window.requestAnimationFrame(e);r+=l;var t=r*u%360;var p=r%360;var h=p===t;h&&(d=!d,t-=1);n.fillStyle="#f9f9f9";n.strokeStyle="#111";n.fillRect(s/2-2*c,a/2-2*c,4*c,4*c);n.beginPath();n.arc(s/2+.5,a/2+.5,c,t*o,p*o,d);n.stroke();n.strokeStyle="#999";n.beginPath();n.arc(s/2+.5,a/2+.5,c,p*o,t*o,d);n.stroke();n.closePath()},stop:function(){window.cancelAnimationFrame(i)}}}}),e("skylark-jsbin-chrome/prettyDate",["skylark-jquery","skylark-jsbin-base/storage","./jsbin","./chrome"],function(e,t,n,i){function o(e){"use strict";var t=new Date((e||"").replace("Z","+0000").replace(/-/g,"/").replace(/[TZ]/g," ")),n=((new Date).getTime()-t.getTime())/1e3,i=Math.floor(n/86400);if(!(isNaN(i)||i<0))return 0===i&&((n<60?"just now":n<120&&"1 minute ago")||n<3600&&Math.floor(n/60)+" minutes ago"||n<7200&&"1 hour ago"||n<86400&&Math.floor(n/3600)+" hours ago")||function(e){var t=new Date(e),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],i=t.getDate()+"",o=t.getFullYear();return(new Date).getFullYear()===o?i+" "+n:i+" "+n+" "+o}(t.getTime())}return e.fn.prettyDate=function(){"use strict";return this.each(function(){var t=o(this.getAttribute("pubdate"));t&&e(this).text(t)})},i.prettyDate=o}),e("skylark-jsbin-client/chrome/infocard",["skylark-jquery","skylark-jsbin-chrome/hideOpen","skylark-jsbin-chrome/spinner","skylark-jsbin-chrome/prettyDate","skylark-jsbin-coder/editors/panels","../jsbin","./analytics"],function(e,t,n,i,o,s,a){if("EventSource"in window)return r();function r(){"use strict";if(!s.embed){var r=e("#infocard"),c=r.find("header"),l=c.find("canvas")[0],u=n(l),d=o.named.html,p=0,h=null,f={head:/<head(.*)\n/i,meta:/(<meta name="description" content=")([^"]*)/im,title:/<title>(.*)<\/title>/im};0!==r.length&&(r.find(".settings")&&(r.find("#title").on("input",function(){v("title");var e=d.getCode(),t=this.value,n=e.replace(f.title,function(e,n){return"<title>"+t.replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</title>"});k(n),s.state.updateSettings({title:this.value})}),r.find("#description").on("input",function(){v("meta");var e=d.getCode(),t=this.value,n=e.replace(f.meta,function(e,n){return n+t.replace(/"/g,"&quot;")});k(n),s.state.updateSettings({description:this.value})})),function(){function n(){var t={};r.find(".row").each(function(){e(this).find('[name="header-value"]').val().trim()&&(t[e(this).find("input:first").val()]=e(this).find("input:last").val())}),s.state.updateSettings({headers:t},"PUT")}e("a.more").add(c).on("mousedown touchstart",function(e){var n;s.infocardVisible=!s.infocardVisible,t(),e.preventDefault(),a.infocard("click","no-result"),r.toggleClass(function(e,t){return n=-1===t.indexOf("open")?"open":"close",s.infocardVisible="open"===n,"open"}).trigger(n)}),r.one("open",function(){var t=e("#status").data("status")||200;e.getJSON(s.static+"/js/http-codes.json",function(n){var i="";n.forEach(function(e){i+='<option value="'+e.code+'">'+e.string+"</option>"}),e("#status").html(i).val(t).on("change",function(){s.state.updateSettings({statusCode:this.value})})})}).on("close",function(){});var i=r.find("#headers");r.on("click","#headers button",function(e){e.preventDefault();var t=i.find("span:last");n();var o=t.clone(!0);t.before(o),t.find("input").val("").eq(0).focus()}),r.on("input",".row input",function(){n(e(this).closest(".row"))})}(),y(),s.$document.bind("saved",y))}function m(e,t){var n=t?JSON.parse(t):JSON.parse(e.data);if(n.connections>0&&0===p&&r.addClass("viewers"),p!==n.connections){var i=c.find(".viewers b").removeClass("up down").html("<b>"+n.connections+"<br>"+p+"<br>"+n.connections+"</b>"),o=p>n.connections?"down":"up";setTimeout(function(){i.addClass(o)},0)}0===(p=n.connections)&&setTimeout(function(){r.removeClass("viewers")},250)}function g(e){window.EventSource&&e&&(h&&h.close(),(h=new EventSource(s.getURL()+"/stats?checksum="+s.state.checksum)).addEventListener("stats",s.throttle(m,1e3)))}function v(e){d.editor;var t=d.getCode();if("meta"===e&&(e='meta name="description'),-1===t.indexOf("<"+e)){var n=function(e,t){var n=s.state.processors.html;if(t=t.replace(/"/g,"&quot;"),"title"===e)return"jade"===n?"title "+t+"\n":"<title>"+t+"</title>\n";if("description"===e)return"jade"===n?'meta(name="description", content="'+t+'")\n':'<meta name="description" content="'+t+'">\n';return t}("title"===e?"title":"description","");t=f.head.test(t)?t.replace(f.head,"<head$1\n"+n):n+t,d.setCode(t)}}function k(e){var t=null,n=null,i=d.editor,a=i.somethingSelected();o.named.html.visible&&(a&&(t=i.listSelections()),n=i.getCursor()),d.setCode(e),o.named.html.visible&&(s.mobile||i.setCursor(n),a&&i.setSelections(t))}function y(t){var n=s.state.metadata||{},o=[],a=!1;if(n.name&&(c.find(".name b").html(n.name),c.find("img").attr("src",n.avatar),o.push(n.name)),(s.state.checksum||s.user&&n.name===s.user.name)&&(a=!0,o.push("author")),u&&u.stop(),s.state.streaming&&!0!==a?!1===a&&(c.find("time").html("Streaming"),o.push("streaming"),u&&u.start()):c.find("time").html(t?"just now":i(n.last_updated)),s.checksum||o.push("meta"),n.pro&&o.push("pro"),c.find(".visibility").text(n.visibility),"private"===n.visibility?o.push("private"):"public"===n.visibility&&o.push("public"),s.state.code&&r.addClass(o.join(" ")).parent().removeAttr("hidden"),s.state.streaming)if(window.EventSource&&a){g(a),function(e){var t="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"mozHidden"in document?"mozHidden":null;if("visibilityState"in document||("webkitVisibilityState"in document||"mozVisibilityState"in document)){var n=t.replace(/hidden/i,"visibilitychange");document.addEventListener(n,function(){document[t]?h.close():g(e)})}}(a);var l=s.getURL();s.$document.on("saved",function(){var e=window.location.toString();l!==e&&(h.close(),g(a))})}else!0===s.saveDisabled&&"/edit"===window.location.pathname.slice(-5)&&(e.getScript(s.static+"/js/spike.js?"+s.version),s.$document.on("stats",s.throttle(m,1e3)))}}e.getScript(s.static+"/js/vendor/eventsource.js",r)}),e("skylark-jsbin-client/chrome/last-bin",["skylark-jquery","../jsbin"],function(e,t){"use strict";function n(){var e,t=window.location.href;document.cookie=t?"last="+encodeURIComponent(t)+"; expires="+((e=new Date).setTime(+e+36e5),e.toUTCString())+"; path=/":'last=""; expires=-1; path=/'}var i,o;t&&t.getURL?(t.$document.on("saved",n),n()):(i=document.getElementById("back"),o=function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}("last"),i&&null!==o&&"%2Fedit"!==o&&(i.href=decodeURIComponent(o)))}),e("skylark-jsbin-client/chrome/transfer",["skylark-jquery","../jsbin"],function(e,t){var n=e("a.transfer").on("click",function(n){n.preventDefault();var i=prompt("Enter the username to transfer this bin to");(i=(i||"").trim().toLowerCase()).length&&e.ajax({url:t.getURL({withRevision:!0})+"/transfer",method:"post",data:{to:i,_csrf:t.state.token},success:function(){window.location.reload()},error:function(e){console.log(e),403===e.status?alert("This bin cannot be transferred as you do not own it."):400===e.status?alert('The user "'+i+"\" couldn't be found, sorry."):alert("Failed to transfer bin")}})});return function(){t.owner()?n.show():n.hide()}}),e("skylark-jsbin-client/chrome/welcome-panel",["skylark-jquery","skylark-jsbin-base/storage","../jsbin","./analytics","./settings"],function(e,t,n,i,o){"use strict";if(e("#toppanel").length){void 0===n.settings.gui&&(n.settings.gui={}),void 0===n.settings.gui.toppanel&&(n.settings.gui.toppanel=!0,t.localStorage.setItem("settings",JSON.stringify(n.settings))),n.$body.hasClass("toppanel")&&!1===n.settings.gui.toppanel&&(n.$body.addClass("toppanel-close"),n.$body.removeClass("toppanel")),i.welcomePanelState(n.settings.gui.toppanel);var s=function(e){n.$body.removeClass("toppanel-slow"),e.shiftKey&&n.$body.addClass("toppanel-slow")};e(".toppanel-logo").on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(e){n.$document.trigger("sizeeditors")}),e(".toppanel-hide").click(function(e){e.preventDefault(),s(e),n.settings.gui.toppanel=!1,o.save(),n.$body.addClass("toppanel-close"),n.$body.removeClass("toppanel")}),e(".toppanel-logo").click(function(e){e.preventDefault(),s(e),n.settings.gui.toppanel=!0,o.save(),n.$body.removeClass("toppanel-close"),n.$body.addClass("toppanel")}),e.ajax({url:"/blog/all.json?"+(new Date).toString().split(" ").slice(0,4).join("-"),dataType:"json",cache:!0,success:function(i){var o=i.blog[0],s=n.root.replace(/^https/,"http");e(".toppanel-blog ul").html('<li><a href="'+s+"/"+o.slug+'" target="_blank" class="toppanel-link">'+o.title.replace(/TWDTW.*:\s/,"")+"</a></li>");var a=null,r=1;try{a=t.localStorage.getItem("lastpost")||null}catch(e){}null!==a&&(r=(a*=1)<o.timestamp?i.blog.reduce(function(e,t){return a<t.timestamp?e+1:e},0):0),r&&e(".blog a").attr("href",s+"/"+i.blog[r-1].slug).attr("data-count",r).on("click",function(){try{t.localStorage.lastpost=i.blog[r-1].timestamp}catch(e){}});var c=function(e){var t,n,i=e.length;for(;i;)n=Math.floor(Math.random()*i--),t=e[i],e[i]=e[n],e[n]=t;return e}(i.help);e(".toppanel-help ul").html('<li><a href="'+s+"/"+c[0].slug+'" target="_blank" class="toppanel-link">'+c[0].title+'</a></li><li><a href="'+s+"/"+c[1].slug+'" target="_blank" class="toppanel-link">'+c[1].title+"</a></li>")}}),e("#toppanel").find(".toppanel-link").mousedown(function(){i.welcomePanelLink(this.href)})}}),e("skylark-jsbin-client/chrome/help-search",["skylark-jquery","../jsbin"],function(e,t){"use strict";var n=e("#results"),i=e("#result-count"),o=[],s=e("#helpsearch"),a=-1;function r(e,t){var o,s,a;o=e,s="a an and on in it of if for the i is i'm i'd it's or to me be not was do so at are what bin bins".split(" "),a=new RegExp("("+"ing ly lies s".split(" ").join("|")+")$"),e=(o||"").replace(/(<([^>]+)>)/gi,"").replace(/\W/g," ").replace(/["'\.,]/g,"").toLowerCase().split(" ").filter(function(e){return-1===s.indexOf(e.trim())}).filter(function(e,t,n){return n.lastIndexOf(e)===t}).filter(function(e){return e.length>2}).map(function(e){return e.trim().replace(a,"")}).sort();var r=t.map(function(t){var n=e.filter(function(e){return-1!==t.words.indexOf(e)}).length;return{type:t.type,title:t.title,slug:t.slug,category:t.category,matches:n}}).filter(function(e){return e.matches>0}).sort(function(e,t){return t.matches-e.matches});n.html(r.map(function(e){return'<a target="_blank" class="button" href="/'+e.slug+'">'+e.title+("blog"===e.type?" (blog)":"")+"</a>"}).join("\n")),n.show();var c="";1!==r.length&&(c="s"),i.html(r.length+" result"+c)}s.on("input",t.throttle(function(){0===o.length?e.ajax({url:"/help/search.json?"+(new Date).toString().split(" ").slice(0,4).join("-"),dataType:"json",cache:!0,success:function(e){o=e,r(this.value,o)}.bind(this)}):r(this.value,o),a=-1},200)),n.on("mousemove",function(){-1!==a&&(n.children().remove("highlight"),a=-1)}),s.on("keydown",function(e){var t=e.which;if(38===t||40===t){e.preventDefault();var i=1;38===t&&(i=-1),a+=i;var o=n.children(),s=o.length;o.removeClass("hover"),a<0?a=s-1:a>s-1&&(a=0),o.eq(a).addClass("hover")}else if(13===t){var r=n.find(".hover")[0];r&&window.open(r.href)}})}),e("skylark-jsbin-client/chrome/app",["skylark-jquery","skylark-jsbin-coder/editors/codemirror","../jsbin","./gist","./analytics"],function(e,t,n,i,o){if(/gist\/.*/.test(window.location.pathname)&&(window.editors=editors,loadGist=function(){window.gist=new i(window.location.pathname.replace(/.*\/([^/]+)$/,"$1"))},editors.ready?loadGist():n.$document.on("jsbinReady",loadGist)),n.mobile||(document.body.onscroll=window.onscroll=function(){return 0!==document.body.scrollTop&&window.scrollTo(0,0),!1}),window.CodeMirror=t,t.keyMap&&t.keyMap.default){var s="mac"===e.browser.platform?"Cmd":"Ctrl";delete t.keyMap.default[s+"-L"],delete t.keyMap.default[s+"-T"],delete t.keyMap.default[s+"-W"],delete t.keyMap.default[s+"-J"],delete t.keyMap.default[s+"-R"]}n.embed&&o.embed()}),e("skylark-jsbin-client/main",["skylark-jsbin-coder","./jsbin","./chrome/font","./chrome/analytics","./chrome/settings","./render/saved-history-preview","./chrome/esc","./chrome/share","./chrome/issue","./chrome/download","./chrome/login","./chrome/tips","./chrome/keys","./chrome/save","./chrome/navigation","./chrome/file-drop","./chrome/gist","./chrome/infocard","./chrome/last-bin","./chrome/archive","./chrome/transfer","./chrome/welcome-panel","./chrome/help-search","./chrome/app"],function(e,t){return t}),e("skylark-jsbin-client",["skylark-jsbin-client/main"],function(e){return e})}(n),!o){var r=require("skylark-langx-ns");s?module.exports=r:t.skylarkjs=r}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-jsbin-client.js.map
